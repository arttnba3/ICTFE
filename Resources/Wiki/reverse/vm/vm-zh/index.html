<!doctype html>
<html lang="zh" class="no-js">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">

  <meta name="description" content="CTF Wiki">


  <link rel="canonical" href="https://ctf-wiki.github.io/ctf-wiki/reverse/vm/vm-zh/">


  <meta name="author" content="CTF Wiki Team">


  <meta name="lang:clipboard.copy" content="复制">

  <meta name="lang:clipboard.copied" content="已复制">

  <meta name="lang:search.language" content="jp">

  <meta name="lang:search.pipeline.stopwords" content="True">

  <meta name="lang:search.pipeline.trimmer" content="True">

  <meta name="lang:search.result.none" content="没有找到符合条件的结果">

  <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">

  <meta name="lang:search.result.other" content="# 个符合条件的结果">

  <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">

  <link rel="shortcut icon" href="../../../assets/images/favicon.png">
  <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.2">



  <title>Virtual Machine Command Analysis - CTF Wiki</title>



  <link rel="stylesheet" href="../../../assets/stylesheets/application.adb8469c.css">

  <link rel="stylesheet" href="../../../assets/stylesheets/application-palette.a8b3c06d.css">




  <meta name="theme-color" content="">



  <script src="../../../assets/javascripts/modernizr.86422ebf.js"></script>



  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Noto+Sans:300,400,400i,700%7CSource+Code+Pro&display=fallback">
  <style>
    body,
    input {
      font-family: "Noto Sans", "Helvetica Neue", Helvetica, Arial, sans-serif
    }

    code,
    kbd,
    pre {
      font-family: "Source Code Pro", "Courier New", Courier, monospace
    }
  </style>


  <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">


  <link rel="stylesheet" href="../../../stylesheets/dark_theme.css">

  <link rel="stylesheet" href="../../../stylesheets/codehilite.css">

  <link rel="stylesheet" href="../../../_static/css/extra.css">





  <meta name="theme-color" content="#212121">

  <link rel='icon' href='/assets/images/favicon.ico'>

  <meta name='apple-mobile-web-app-capable' content='yes'>
  <meta name='mobile-web-app-capable' content='yes'>
  <link rel="manifest" href="/manifest.json">

</head>



<body dir="ltr" data-md-color-primary="blue" data-md-color-accent="red">

  <svg class="md-svg">
    <defs>


      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github">
        <path fill="currentColor"
          d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z" />
        </svg>

    </defs>
  </svg>
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>

  <a href="#_1" tabindex="0" class="md-skip">
    跳转至
  </a>


  <header class="md-header" data-md-component="header">
    <nav class="md-header-nav md-grid">
      <div class="md-flex">
        <div class="md-flex__cell md-flex__cell--shrink">
          <a href="https://ctf-wiki.github.io/ctf-wiki/" title="CTF Wiki" aria-label="CTF Wiki"
            class="md-header-nav__button md-logo">

            <i class="md-icon">school</i>

          </a>
        </div>
        <div class="md-flex__cell md-flex__cell--shrink">
          <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
        </div>
        <div class="md-flex__cell md-flex__cell--stretch">
          <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">

            <span class="md-header-nav__topic">
              CTF Wiki
            </span>
            <span class="md-header-nav__topic">

              Virtual Machine Command Analysis

            </span>

          </div>
        </div>
        <div class="md-flex__cell md-flex__cell--shrink">

          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>

          <div class="md-search" data-md-component="search" role="dialog">
            <label class="md-search__overlay" for="__search"></label>
            <div class="md-search__inner" role="search">
              <form class="md-search__form" name="search">
                <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="搜索"
                  autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query"
                  data-md-state="active">
                <label class="md-icon md-search__icon" for="__search"></label>
                <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
                  &#xE5CD;
                </button>
              </form>
              <div class="md-search__output">
                <div class="md-search__scrollwrap" data-md-scrollfix>
                  <div class="md-search-result" data-md-component="result">
                    <div class="md-search-result__meta">
                      键入以开始搜索
                    </div>
                    <ol class="md-search-result__list"></ol>
                  </div>
                </div>
              </div>
            </div>
          </div>

        </div>

        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">





            <a href="https://github.com/ctf-wiki/ctf-wiki/" title="前往 Github 仓库" class="md-source"
              data-md-source="github">

              <div class="md-source__icon">
                <svg viewBox="0 0 24 24" width="24" height="24">
                  <use xlink:href="#__github" width="24" height="24"></use>
                </svg>
              </div>

              <div class="md-source__repository">
                ctf-wiki/ctf-wiki
              </div>
            </a>
          </div>
        </div>

      </div>
    </nav>
  </header>

  <div class="md-container">








    <nav class="md-tabs md-tabs--active" data-md-component="tabs">
      <div class="md-tabs__inner md-grid">
        <ul class="md-tabs__list">




          <li class="md-tabs__item">

            <a href="../../.." class="md-tabs__link">
              Introduction
            </a>

          </li>






          <li class="md-tabs__item">

            <a href="../../../misc/introduction-zh/" class="md-tabs__link">
              Misc
            </a>

          </li>






          <li class="md-tabs__item">

            <a href="../../../crypto/introduction-zh/" class="md-tabs__link">
              Crypto
            </a>

          </li>






          <li class="md-tabs__item">

            <a href="../../../web/introduction-zh/" class="md-tabs__link">
              Web
            </a>

          </li>






          <li class="md-tabs__item">

            <a href="../../../assembly/x86-x64/readme-zh/" class="md-tabs__link">
              Assembly
            </a>

          </li>










          <li class="md-tabs__item">

            <a href="../../../executable/elf/elf-structure-zh/" class="md-tabs__link">
              Executable
            </a>

          </li>












          <li class="md-tabs__item">

            <a href="../../introduction-zh/" class="md-tabs__link md-tabs__link--active">
              Reverse Engineering
            </a>

          </li>












          <li class="md-tabs__item">

            <a href="../../../pwn/readme-zh/" class="md-tabs__link">
              Pwn
            </a>

          </li>








          <li class="md-tabs__item">

            <a href="../../../android/basic_develop/basic_develop-zh/" class="md-tabs__link">
              Android
            </a>

          </li>






          <li class="md-tabs__item">

            <a href="../../../ics/ctfs-zh/" class="md-tabs__link">
              ICS
            </a>

          </li>



        </ul>
      </div>
    </nav>

    <main class="md-main" role="main">
      <div class="md-main__inner md-grid" data-md-component="container">


        <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
          <div class="md-sidebar__scrollwrap">
            <div class="md-sidebar__inner">
              <nav class="md-nav md-nav--primary" data-md-level="0">
                <label class="md-nav__title md-nav__title--site" for="__drawer">
                  <a href="https://ctf-wiki.github.io/ctf-wiki/" title="CTF Wiki" class="md-nav__button md-logo">

                    <i class="md-icon">school</i>

                  </a>
                  CTF Wiki
                </label>

                <div class="md-nav__source">





                  <a href="https://github.com/ctf-wiki/ctf-wiki/" title="前往 Github 仓库" class="md-source"
                    data-md-source="github">

                    <div class="md-source__icon">
                      <svg viewBox="0 0 24 24" width="24" height="24">
                        <use xlink:href="#__github" width="24" height="24"></use>
                      </svg>
                    </div>

                    <div class="md-source__repository">
                      ctf-wiki/ctf-wiki
                    </div>
                  </a>
                </div>

                <ul class="md-nav__list" data-md-scrollfix>






                  <li class="md-nav__item md-nav__item--nested">

                    <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">

                    <label class="md-nav__link" for="nav-1">
                      Introduction
                    </label>
                    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
                      <label class="md-nav__title" for="nav-1">
                        Introduction
                      </label>
                      <ul class="md-nav__list" data-md-scrollfix>







                        <li class="md-nav__item">
                          <a href="../../.." title="Getting Started" class="md-nav__link">
                            Getting Started
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../introduction/history-zh/" title="CTF History" class="md-nav__link">
                            CTF History
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../introduction/mode-zh/" title="Introduction to CTF Competition Form"
                            class="md-nav__link">
                            Introduction to CTF Competition Form
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../introduction/content-zh/" title="CTF Contest Content" class="md-nav__link">
                            CTF Contest Content
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../introduction/experience-zh/"
                            title="Offline Attack and Defense Experience Summary" class="md-nav__link">
                            Offline Attack and Defense Experience Summary
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../introduction/cgc-zh/" title="CGC Super Challenge" class="md-nav__link">
                            CGC Super Challenge
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../introduction/resources-zh/" title="Learning Resources" class="md-nav__link">
                            Learning Resources
                          </a>
                        </li>


                      </ul>
                    </nav>
                  </li>







                  <li class="md-nav__item md-nav__item--nested">

                    <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">

                    <label class="md-nav__link" for="nav-2">
                      Misc
                    </label>
                    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
                      <label class="md-nav__title" for="nav-2">
                        Misc
                      </label>
                      <ul class="md-nav__list" data-md-scrollfix>







                        <li class="md-nav__item">
                          <a href="../../../misc/introduction-zh/" title="Miscellaneous Introduction"
                            class="md-nav__link">
                            Miscellaneous Introduction
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../misc/recon-zh/" title="Information Gathering Technology"
                            class="md-nav__link">
                            Information Gathering Technology
                          </a>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3">

                          <label class="md-nav__link" for="nav-2-3">
                            Code Analysis
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-2-3">
                              Code Analysis
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../misc/encode/communication-zh/"
                                  title="Commonly Used Coding in the Communication Field" class="md-nav__link">
                                  Commonly Used Coding in the Communication Field
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../misc/encode/computer-zh/" title="Computer Related Coding"
                                  class="md-nav__link">
                                  Computer Related Coding
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../misc/encode/modern-zh/"
                                  title="Commonly Used Encodings in the Real World" class="md-nav__link">
                                  Commonly Used Encodings in the Real World
                                </a>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../misc/prefix-zh/" title="Forensic Steganography" class="md-nav__link">
                            Forensic Steganography
                          </a>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-5" type="checkbox" id="nav-2-5">

                          <label class="md-nav__link" for="nav-2-5">
                            Image Analysis
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-2-5">
                              Image Analysis
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../misc/picture/introduction-zh/" title="Introduction to Image Analysis"
                                  class="md-nav__link">
                                  Introduction to Image Analysis
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../misc/picture/png-zh/" title="PNG" class="md-nav__link">
                                  PNG
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../misc/picture/jpg-zh/" title="JPG" class="md-nav__link">
                                  JPG
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../misc/picture/gif-zh/" title="GIF" class="md-nav__link">
                                  GIF
                                </a>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-6" type="checkbox" id="nav-2-6">

                          <label class="md-nav__link" for="nav-2-6">
                            Traffic Packet Analysis
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-2-6">
                              Traffic Packet Analysis
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../misc/traffic/introduction-zh/"
                                  title="Introduction to Traffic Packet Analysis" class="md-nav__link">
                                  Introduction to Traffic Packet Analysis
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../misc/traffic/fix-zh/" title="PCAP File Repairing"
                                  class="md-nav__link">
                                  PCAP File Repairing
                                </a>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-6-3" type="checkbox"
                                  id="nav-2-6-3">

                                <label class="md-nav__link" for="nav-2-6-3">
                                  Protocol Analysis
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-2-6-3">
                                    Protocol Analysis
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../misc/traffic/protocols/README-zh/"
                                        title="Overview of Protocol Analysis" class="md-nav__link">
                                        Overview of Protocol Analysis
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../misc/traffic/protocols/Wireshark-zh/" title="Wireshark"
                                        class="md-nav__link">
                                        Wireshark
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../misc/traffic/protocols/HTTP-zh/" title="HTTP"
                                        class="md-nav__link">
                                        HTTP
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../misc/traffic/protocols/HTTPS-zh/" title="HTTPS"
                                        class="md-nav__link">
                                        HTTPS
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../misc/traffic/protocols/FTP-zh/" title="FTP"
                                        class="md-nav__link">
                                        FTP
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../misc/traffic/protocols/DNS-zh/" title="DNS"
                                        class="md-nav__link">
                                        DNS
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../misc/traffic/protocols/WIFI-zh/" title="WIFI"
                                        class="md-nav__link">
                                        WIFI
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../misc/traffic/protocols/USB-zh/" title="USB"
                                        class="md-nav__link">
                                        USB
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../misc/traffic/data-zh/" title="Data Extraction" class="md-nav__link">
                                  Data Extraction
                                </a>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-7" type="checkbox" id="nav-2-7">

                          <label class="md-nav__link" for="nav-2-7">
                            Compressed Package Analysis
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-2-7">
                              Compressed Package Analysis
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../misc/archive/zip-zh/" title="ZIP Format" class="md-nav__link">
                                  ZIP Format
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../misc/archive/rar-zh/" title="RAR Format" class="md-nav__link">
                                  RAR Format
                                </a>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../misc/audio/introduction-zh/" title="Audio Steganography"
                            class="md-nav__link">
                            Audio Steganography
                          </a>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-9" type="checkbox" id="nav-2-9">

                          <label class="md-nav__link" for="nav-2-9">
                            Disk Memory Analysis
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-2-9">
                              Disk Memory Analysis
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../misc/disk-memory/introduction-zh/" title="Introduction"
                                  class="md-nav__link">
                                  Introduction
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../misc/disk-memory/problem-zh/" title="Title" class="md-nav__link">
                                  Title
                                </a>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-10" type="checkbox"
                            id="nav-2-10">

                          <label class="md-nav__link" for="nav-2-10">
                            Other
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-2-10">
                              Other
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../misc/other/pyc-zh/" title="pyc File" class="md-nav__link">
                                  pyc File
                                </a>
                              </li>


                            </ul>
                          </nav>
                        </li>


                      </ul>
                    </nav>
                  </li>







                  <li class="md-nav__item md-nav__item--nested">

                    <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">

                    <label class="md-nav__link" for="nav-3">
                      Crypto
                    </label>
                    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
                      <label class="md-nav__title" for="nav-3">
                        Crypto
                      </label>
                      <ul class="md-nav__list" data-md-scrollfix>







                        <li class="md-nav__item">
                          <a href="../../../crypto/introduction-zh/" title="Introduction to Cryptography"
                            class="md-nav__link">
                            Introduction to Cryptography
                          </a>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">

                          <label class="md-nav__link" for="nav-3-2">
                            Basic Mathematics
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-3-2">
                              Basic Mathematics
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../crypto/basic/introduction-zh/" title="Introduction"
                                  class="md-nav__link">
                                  Introduction
                                </a>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3">

                          <label class="md-nav__link" for="nav-3-3">
                            Classical Cryptography
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-3-3">
                              Classical Cryptography
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../crypto/classical/introduction-zh/"
                                  title="Introduction to Classical Cryptography" class="md-nav__link">
                                  Introduction to Classical Cryptography
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../crypto/classical/monoalphabetic-zh/"
                                  title="Single table Substitution Cipher" class="md-nav__link">
                                  Single table Substitution Cipher
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../crypto/classical/polyalphabetic-zh/"
                                  title="Multi-table Substitution Cipher" class="md-nav__link">
                                  Multi-table Substitution Cipher
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../crypto/classical/others-zh/" title="Other Types of Cipher"
                                  class="md-nav__link">
                                  Other Types of Cipher
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../crypto/classical/summary-zh/" title="Summary" class="md-nav__link">
                                  Summary
                                </a>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4" type="checkbox" id="nav-3-4">

                          <label class="md-nav__link" for="nav-3-4">
                            Stream Cipher
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-3-4">
                              Stream Cipher
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../crypto/streamcipher/intro-zh/" title="Introduction"
                                  class="md-nav__link">
                                  Introduction
                                </a>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4-2" type="checkbox"
                                  id="nav-3-4-2">

                                <label class="md-nav__link" for="nav-3-4-2">
                                  Pseudo Random Number Generator
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-3-4-2">
                                    Pseudo Random Number Generator
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/streamcipher/prng/intro-zh/" title="Introduction"
                                        class="md-nav__link">
                                        Introduction
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/streamcipher/prng/csprng-zh/"
                                        title="Cryptographic Security Pseudo-random Number Generator"
                                        class="md-nav__link">
                                        Cryptographic Security Pseudo-random Number Generator
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/streamcipher/prng/problem-zh/" title="Challenge Examples"
                                        class="md-nav__link">
                                        Challenge Examples
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4-3" type="checkbox"
                                  id="nav-3-4-3">

                                <label class="md-nav__link" for="nav-3-4-3">
                                  Linear Congruence Generator
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-3-4-3">
                                    Linear Congruence Generator
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/streamcipher/lcg/intro-zh/" title="Introduction"
                                        class="md-nav__link">
                                        Introduction
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/streamcipher/lcg/challenge-zh/" title="Example"
                                        class="md-nav__link">
                                        Example
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4-4" type="checkbox"
                                  id="nav-3-4-4">

                                <label class="md-nav__link" for="nav-3-4-4">
                                  Feedback Shift Register
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-3-4-4">
                                    Feedback Shift Register
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/streamcipher/fsr/intro-zh/" title="Introduction"
                                        class="md-nav__link">
                                        Introduction
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/streamcipher/fsr/lfsr-zh/"
                                        title="Linear Feedback Shift Register" class="md-nav__link">
                                        Linear Feedback Shift Register
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/streamcipher/fsr/nfsr-zh/"
                                        title="Nonlinear Feedback Shift Register" class="md-nav__link">
                                        Nonlinear Feedback Shift Register
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4-5" type="checkbox"
                                  id="nav-3-4-5">

                                <label class="md-nav__link" for="nav-3-4-5">
                                  Special Stream Cipher
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-3-4-5">
                                    Special Stream Cipher
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/streamcipher/special/rc4-zh/" title="RC4"
                                        class="md-nav__link">
                                        RC4
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5" type="checkbox" id="nav-3-5">

                          <label class="md-nav__link" for="nav-3-5">
                            Block Cipher
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-3-5">
                              Block Cipher
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../crypto/blockcipher/introduction-zh/"
                                  title="Introduction to Block Cipher" class="md-nav__link">
                                  Introduction to Block Cipher
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../crypto/blockcipher/arx-operations-zh/" title="ARX"
                                  class="md-nav__link">
                                  ARX
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../crypto/blockcipher/des-zh/" title="DES" class="md-nav__link">
                                  DES
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../crypto/blockcipher/idea-zh/" title="IDEA" class="md-nav__link">
                                  IDEA
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../crypto/blockcipher/aes-zh/" title="AES" class="md-nav__link">
                                  AES
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../crypto/blockcipher/simon-speck-zh/" title="Simon and Speck"
                                  class="md-nav__link">
                                  Simon and Speck
                                </a>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5-7" type="checkbox"
                                  id="nav-3-5-7">

                                <label class="md-nav__link" for="nav-3-5-7">
                                  Group Mode
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-3-5-7">
                                    Group Mode
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/blockcipher/mode/introduction-zh/" title="Introduction"
                                        class="md-nav__link">
                                        Introduction
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/blockcipher/mode/padding-zh/" title="Padding Methods"
                                        class="md-nav__link">
                                        Padding Methods
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/blockcipher/mode/ecb-zh/" title="ECB"
                                        class="md-nav__link">
                                        ECB
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/blockcipher/mode/cbc-zh/" title="CBC"
                                        class="md-nav__link">
                                        CBC
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/blockcipher/mode/pcbc-zh/" title="PCBC"
                                        class="md-nav__link">
                                        PCBC
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/blockcipher/mode/cfb-zh/" title="CFB"
                                        class="md-nav__link">
                                        CFB
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/blockcipher/mode/ofb-zh/" title="OFB"
                                        class="md-nav__link">
                                        OFB
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/blockcipher/mode/ctr-zh/" title="CTR"
                                        class="md-nav__link">
                                        CTR
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/blockcipher/mode/padding-oracle-attack-zh/"
                                        title="Padding Oracle Attack" class="md-nav__link">
                                        Padding Oracle Attack
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-6" type="checkbox" id="nav-3-6">

                          <label class="md-nav__link" for="nav-3-6">
                            Asymmetric Cryptography
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-3-6">
                              Asymmetric Cryptography
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../crypto/asymmetric/introduction-zh/"
                                  title="Introduction to Asymmetric Cryptography" class="md-nav__link">
                                  Introduction to Asymmetric Cryptography
                                </a>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-6-2" type="checkbox"
                                  id="nav-3-6-2">

                                <label class="md-nav__link" for="nav-3-6-2">
                                  RSA
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-3-6-2">
                                    RSA
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/asymmetric/rsa/rsa_theory-zh/" title="RSA Introduction"
                                        class="md-nav__link">
                                        RSA Introduction
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/asymmetric/rsa/rsa_module_attack-zh/"
                                        title="Modulo-related Attacks" class="md-nav__link">
                                        Modulo-related Attacks
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/asymmetric/rsa/rsa_e_attack-zh/"
                                        title="Public Key Index Related Attacks" class="md-nav__link">
                                        Public Key Index Related Attacks
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/asymmetric/rsa/rsa_d_attack-zh/"
                                        title="Private Key d Related Attacks" class="md-nav__link">
                                        Private Key d Related Attacks
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/asymmetric/rsa/rsa_coppersmith_attack-zh/"
                                        title="Coppersmith Related Attacks" class="md-nav__link">
                                        Coppersmith Related Attacks
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/asymmetric/rsa/rsa_chosen_plain_cipher-zh/"
                                        title="Chosen Plain Cipher Attack" class="md-nav__link">
                                        Chosen Plain Cipher Attack
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/asymmetric/rsa/rsa_side_channel-zh/"
                                        title="Side Channel Attack" class="md-nav__link">
                                        Side Channel Attack
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/asymmetric/rsa/rsa_pkcs_attack-zh/"
                                        title="Bleichenbacher Attack" class="md-nav__link">
                                        Bleichenbacher Attack
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/asymmetric/rsa/rsa_complex-zh/"
                                        title="Challenge Examples" class="md-nav__link">
                                        Challenge Examples
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../crypto/asymmetric/knapsack/knapsack-zh/" title="Knapsack Cipher"
                                  class="md-nav__link">
                                  Knapsack Cipher
                                </a>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-6-4" type="checkbox"
                                  id="nav-3-6-4">

                                <label class="md-nav__link" for="nav-3-6-4">
                                  Discrete Log Correlation
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-3-6-4">
                                    Discrete Log Correlation
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/asymmetric/discrete-log/discrete-log-zh/"
                                        title="Discrete Logarithm" class="md-nav__link">
                                        Discrete Logarithm
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/asymmetric/discrete-log/elgamal-zh/" title="Elgamal"
                                        class="md-nav__link">
                                        Elgamal
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/asymmetric/discrete-log/ecc-zh/" title="ECC"
                                        class="md-nav__link">
                                        ECC
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-6-5" type="checkbox"
                                  id="nav-3-6-5">

                                <label class="md-nav__link" for="nav-3-6-5">
                                  Lattice-based Cryptography
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-3-6-5">
                                    Lattice-based Cryptography
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/asymmetric/lattice/overview-zh/" title="Lattice Overview"
                                        class="md-nav__link">
                                        Lattice Overview
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/asymmetric/lattice/introduction-zh/"
                                        title="Introduction to Lattices" class="md-nav__link">
                                        Introduction to Lattices
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/asymmetric/lattice/lattice-reduction-zh/"
                                        title="Lattice-based Algorithm" class="md-nav__link">
                                        Lattice-based Algorithm
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../crypto/asymmetric/lattice/cvp-zh/" title="CVP"
                                        class="md-nav__link">
                                        CVP
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-7" type="checkbox" id="nav-3-7">

                          <label class="md-nav__link" for="nav-3-7">
                            Hash Function
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-3-7">
                              Hash Function
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../crypto/hash/introduction-zh/"
                                  title="Introduction to the Hash Function" class="md-nav__link">
                                  Introduction to the Hash Function
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../crypto/hash/md5-zh/" title="MD5" class="md-nav__link">
                                  MD5
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../crypto/hash/sha1-zh/" title="SHA1" class="md-nav__link">
                                  SHA1
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../crypto/hash/fnv-zh/" title="FNV" class="md-nav__link">
                                  FNV
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../crypto/hash/attack-zh/" title="Hash Attack" class="md-nav__link">
                                  Hash Attack
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../crypto/hash/complex-zh/" title="Challenge Examples"
                                  class="md-nav__link">
                                  Challenge Examples
                                </a>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-8" type="checkbox" id="nav-3-8">

                          <label class="md-nav__link" for="nav-3-8">
                            Digital Signature
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-3-8">
                              Digital Signature
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../crypto/signature/introduction-zh/"
                                  title="Introduction to Digital Signatures" class="md-nav__link">
                                  Introduction to Digital Signatures
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../crypto/signature/rsa-zh/" title="RSA Digital Signature"
                                  class="md-nav__link">
                                  RSA Digital Signature
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../crypto/signature/elgamal-zh/" title="ElGamal Digital Signature"
                                  class="md-nav__link">
                                  ElGamal Digital Signature
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../crypto/signature/dsa-zh/" title="DSA Digital Signature"
                                  class="md-nav__link">
                                  DSA Digital Signature
                                </a>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-9" type="checkbox" id="nav-3-9">

                          <label class="md-nav__link" for="nav-3-9">
                            Summary of Attack Techniques
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-3-9">
                              Summary of Attack Techniques
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../crypto/attack-summary/attack-mode-zh/" title="Introduction"
                                  class="md-nav__link">
                                  Introduction
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../crypto/attack-summary/meet-in-the-middle-zh/"
                                  title="Intermediate Encounter Attack" class="md-nav__link">
                                  Intermediate Encounter Attack
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../crypto/attack-summary/bit-attack-zh/" title="Bit attack"
                                  class="md-nav__link">
                                  Bit attack
                                </a>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../crypto/certificate/introduction-zh/" title="Certificate Format"
                            class="md-nav__link">
                            Certificate Format
                          </a>
                        </li>


                      </ul>
                    </nav>
                  </li>







                  <li class="md-nav__item md-nav__item--nested">

                    <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">

                    <label class="md-nav__link" for="nav-4">
                      Web
                    </label>
                    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
                      <label class="md-nav__title" for="nav-4">
                        Web
                      </label>
                      <ul class="md-nav__list" data-md-scrollfix>







                        <li class="md-nav__item">
                          <a href="../../../web/introduction-zh/" title="Introduction to Web Applications"
                            class="md-nav__link">
                            Introduction to Web Applications
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../web/sqli-zh/" title="SQL Injection" class="md-nav__link">
                            SQL Injection
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../web/xss-zh/" title="XSS Cross-site Scripting Attack" class="md-nav__link">
                            XSS Cross-site Scripting Attack
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../web/csrf-zh/" title="CSRF Cross-site Request Forgery" class="md-nav__link">
                            CSRF Cross-site Request Forgery
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../web/ssrf-zh/" title="SSRF Server Request Forgery" class="md-nav__link">
                            SSRF Server Request Forgery
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../web/php/php-zh/" title="PHP Code Auditing" class="md-nav__link">
                            PHP Code Auditing
                          </a>
                        </li>


                      </ul>
                    </nav>
                  </li>







                  <li class="md-nav__item md-nav__item--nested">

                    <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">

                    <label class="md-nav__link" for="nav-5">
                      Assembly
                    </label>
                    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
                      <label class="md-nav__title" for="nav-5">
                        Assembly
                      </label>
                      <ul class="md-nav__list" data-md-scrollfix>







                        <li class="md-nav__item">
                          <a href="../../../assembly/x86-x64/readme-zh/" title="x86_x64" class="md-nav__link">
                            x86_x64
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../assembly/mips/readme-zh/" title="mips" class="md-nav__link">
                            mips
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../assembly/arm/readme-zh/" title="arm" class="md-nav__link">
                            arm
                          </a>
                        </li>


                      </ul>
                    </nav>
                  </li>







                  <li class="md-nav__item md-nav__item--nested">

                    <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">

                    <label class="md-nav__link" for="nav-6">
                      Executable
                    </label>
                    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
                      <label class="md-nav__title" for="nav-6">
                        Executable
                      </label>
                      <ul class="md-nav__list" data-md-scrollfix>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-1" type="checkbox" id="nav-6-1">

                          <label class="md-nav__link" for="nav-6-1">
                            ELF file
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-6-1">
                              ELF file
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../executable/elf/elf-structure-zh/" title="ELF File Basic Structure"
                                  class="md-nav__link">
                                  ELF File Basic Structure
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../executable/elf/program-loading-zh/" title="Program Loading"
                                  class="md-nav__link">
                                  Program Loading
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../executable/elf/program-linking-zh/" title="Program Link"
                                  class="md-nav__link">
                                  Program Link
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../executable/elf/running-overview-zh/" title="Program Execution Flow"
                                  class="md-nav__link">
                                  Program Execution Flow
                                </a>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2" type="checkbox" id="nav-6-2">

                          <label class="md-nav__link" for="nav-6-2">
                            PE file
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-6-2">
                              PE file
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../executable/pe/pe-excutable-zh/" title="PE File Basic Structure"
                                  class="md-nav__link">
                                  PE File Basic Structure
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../executable/pe/pe-import-table-zh/" title="PE Import Table"
                                  class="md-nav__link">
                                  PE Import Table
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../executable/pe/pe-export-table-zh/" title="PE Export Table"
                                  class="md-nav__link">
                                  PE Export Table
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../../executable/pe/pe-relocation-table-zh/" title="PE Relocation Table"
                                  class="md-nav__link">
                                  PE Relocation Table
                                </a>
                              </li>


                            </ul>
                          </nav>
                        </li>


                      </ul>
                    </nav>
                  </li>









                  <li class="md-nav__item md-nav__item--active md-nav__item--nested">

                    <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" checked>

                    <label class="md-nav__link" for="nav-7">
                      Reverse Engineering
                    </label>
                    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
                      <label class="md-nav__title" for="nav-7">
                        Reverse Engineering
                      </label>
                      <ul class="md-nav__list" data-md-scrollfix>









                        <li class="md-nav__item md-nav__item--active md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-1" type="checkbox" id="nav-7-1"
                            checked>

                          <label class="md-nav__link" for="nav-7-1">
                            Reverse Overview
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-7-1">
                              Reverse Overview
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../introduction-zh/" title="Software Reverse Engineering Introduction"
                                  class="md-nav__link">
                                  Software Reverse Engineering Introduction
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../Identify-Encode-Encryption/introduction-zh/"
                                  title="Common Encryption Algorithms and Code Recognition" class="md-nav__link">
                                  Common Encryption Algorithms and Code Recognition
                                </a>
                              </li>







                              <li class="md-nav__item">
                                <a href="../../maze/maze-zh/" title="Labyrinth Problem" class="md-nav__link">
                                  Labyrinth Problem
                                </a>
                              </li>









                              <li class="md-nav__item md-nav__item--active">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">




                                <label class="md-nav__link md-nav__link--active" for="__toc">
                                  Virtual Machine Command Analysis
                                </label>

                                <a href="./" title="Virtual Machine Command Analysis"
                                  class="md-nav__link md-nav__link--active">
                                  Virtual Machine Command Analysis
                                </a>


                                <nav class="md-nav md-nav--secondary">





                                  <label class="md-nav__title" for="__toc">目录</label>
                                  <ul class="md-nav__list" data-md-scrollfix>

                                    <li class="md-nav__item">
                                      <a href="#_2" class="md-nav__link">
                                        运行程序
                                      </a>

                                    </li>

                                    <li class="md-nav__item">
                                      <a href="#_3" class="md-nav__link">
                                        获取用户输入
                                      </a>

                                    </li>

                                    <li class="md-nav__item">
                                      <a href="#_4" class="md-nav__link">
                                        处理用户输入
                                      </a>

                                    </li>

                                    <li class="md-nav__item">
                                      <a href="#seh" class="md-nav__link">
                                        注册SEH
                                      </a>

                                    </li>

                                    <li class="md-nav__item">
                                      <a href="#_5" class="md-nav__link">
                                        恢复堆栈平衡
                                      </a>

                                    </li>

                                    <li class="md-nav__item">
                                      <a href="#_6" class="md-nav__link">
                                        虚拟机指令分析
                                      </a>

                                    </li>





                                    <li class="md-nav__item">
                                      <a href="#__comments" class="md-nav__link md-nav__link--active">
                                        评论
                                      </a>
                                    </li>

                                  </ul>

                                </nav>

                              </li>







                              <li class="md-nav__item">
                                <a href="../../unicorn/introduction-zh/" title="Unicorn Engine Introduction"
                                  class="md-nav__link">
                                  Unicorn Engine Introduction
                                </a>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-2" type="checkbox" id="nav-7-2">

                          <label class="md-nav__link" for="nav-7-2">
                            Linux Reverse
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-7-2">
                              Linux Reverse
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-2-1" type="checkbox"
                                  id="nav-7-2-1">

                                <label class="md-nav__link" for="nav-7-2-1">
                                  Linux Reverse Technology
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-7-2-1">
                                    Linux Reverse Technology
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../linux/ld_preload-zh/" title="LD_PRELOAD" class="md-nav__link">
                                        LD_PRELOAD
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../linux/false-disasm-zh/" title="Incorrect Disassembly Fix"
                                        class="md-nav__link">
                                        Incorrect Disassembly Fix
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../linux/detect-bp-zh/" title="Detecting Breakpoints Bypassing"
                                        class="md-nav__link">
                                        Detecting Breakpoints Bypassing
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../linux/detect-dbg-zh/" title="Detecting Debugging Bypassing"
                                        class="md-nav__link">
                                        Detecting Debugging Bypassing
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-3" type="checkbox" id="nav-7-3">

                          <label class="md-nav__link" for="nav-7-3">
                            Windows Reverse
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-7-3">
                              Windows Reverse
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-3-1" type="checkbox"
                                  id="nav-7-3-1">

                                <label class="md-nav__link" for="nav-7-3-1">
                                  Shelling Technology
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-7-3-1">
                                    Shelling Technology
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../windows/unpack/packer-introduction-zh/"
                                        title="Introduction to the Protective case" class="md-nav__link">
                                        Introduction to the Protective case
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../windows/unpack/trace-zh/" title="Single Step Tracking Method"
                                        class="md-nav__link">
                                        Single Step Tracking Method
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../windows/unpack/esp-zh/" title="ESP Law" class="md-nav__link">
                                        ESP Law
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../windows/unpack/direct-oep-zh/" title="One Step to the OEP Method"
                                        class="md-nav__link">
                                        One Step to the OEP Method
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../windows/unpack/memory-zh/" title="Memory Mirroring Method"
                                        class="md-nav__link">
                                        Memory Mirroring Method
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../windows/unpack/last-exception-zh/" title="Last Exception Method"
                                        class="md-nav__link">
                                        Last Exception Method
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../windows/unpack/sfx-zh/" title="SFX Method" class="md-nav__link">
                                        SFX Method
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../windows/unpack/fix-iat-zh/" title="DUMP and IAT Reconstruction"
                                        class="md-nav__link">
                                        DUMP and IAT Reconstruction
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../windows/unpack/manually-fix-iat-zh/"
                                        title="Manually Find the IAT and Rebuild It Using ImportREC"
                                        class="md-nav__link">
                                        Manually Find the IAT and Rebuild It Using ImportREC
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../windows/unpack/unpack-dll-zh/" title="DLL File Unpacking"
                                        class="md-nav__link">
                                        DLL File Unpacking
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-3-2" type="checkbox"
                                  id="nav-7-3-2">

                                <label class="md-nav__link" for="nav-7-3-2">
                                  Anti-debugging Technology
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-7-3-2">
                                    Anti-debugging Technology
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../windows/anti-debug/ntglobalflag-zh/" title="NtGlobalFlag"
                                        class="md-nav__link">
                                        NtGlobalFlag
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../windows/anti-debug/heap-flags-zh/" title="Heap Flags"
                                        class="md-nav__link">
                                        Heap Flags
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../windows/anti-debug/the-heap-zh/" title="The Heap"
                                        class="md-nav__link">
                                        The Heap
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../windows/anti-debug/int-3-zh/" title="Interrupt 3"
                                        class="md-nav__link">
                                        Interrupt 3
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../windows/anti-debug/isdebuggerpresent-zh/" title="IsDebuggerPresent"
                                        class="md-nav__link">
                                        IsDebuggerPresent
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../windows/anti-debug/checkremotedebuggerpresent-zh/"
                                        title="CheckRemoteDebuggerPresent" class="md-nav__link">
                                        CheckRemoteDebuggerPresent
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../windows/anti-debug/ntqueryinformationprocess-zh/"
                                        title="NtQueryInformationProcess" class="md-nav__link">
                                        NtQueryInformationProcess
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../windows/anti-debug/junk-code-zh/" title="Flower command"
                                        class="md-nav__link">
                                        Flower command
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../windows/anti-debug/example-zh/"
                                        title="Anti-debug technical example" class="md-nav__link">
                                        Anti-debug technical example
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>


                            </ul>
                          </nav>
                        </li>


                      </ul>
                    </nav>
                  </li>







                  <li class="md-nav__item md-nav__item--nested">

                    <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">

                    <label class="md-nav__link" for="nav-8">
                      Pwn
                    </label>
                    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
                      <label class="md-nav__title" for="nav-8">
                        Pwn
                      </label>
                      <ul class="md-nav__list" data-md-scrollfix>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-1" type="checkbox" id="nav-8-1">

                          <label class="md-nav__link" for="nav-8-1">
                            Pwn Overview
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-8-1">
                              Pwn Overview
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../pwn/readme-zh/" title="Readme zh" class="md-nav__link">
                                  Readme zh
                                </a>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2" type="checkbox" id="nav-8-2">

                          <label class="md-nav__link" for="nav-8-2">
                            Linux Pwn
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-8-2">
                              Linux Pwn
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-1" type="checkbox"
                                  id="nav-8-2-1">

                                <label class="md-nav__link" for="nav-8-2-1">
                                  Security Protection Mechanism
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-8-2-1">
                                    Security Protection Mechanism
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/mitigation/canary-zh/" title="Canary"
                                        class="md-nav__link">
                                        Canary
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-2" type="checkbox"
                                  id="nav-8-2-2">

                                <label class="md-nav__link" for="nav-8-2-2">
                                  Stack Overflow
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-8-2-2">
                                    Stack Overflow
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/stackoverflow/stack-intro-zh/"
                                        title="Stack Introduction" class="md-nav__link">
                                        Stack Introduction
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/stackoverflow/stackoverflow-basic-zh/"
                                        title="Stack Overflow Principle" class="md-nav__link">
                                        Stack Overflow Principle
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/stackoverflow/basic-rop-zh/" title="Basic ROP"
                                        class="md-nav__link">
                                        Basic ROP
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/stackoverflow/medium-rop-zh/" title="Intermediate ROP"
                                        class="md-nav__link">
                                        Intermediate ROP
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/stackoverflow/advanced-rop-zh/" title="Advanced ROP"
                                        class="md-nav__link">
                                        Advanced ROP
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/stackoverflow/fancy-rop-zh/" title="ROP Tricks"
                                        class="md-nav__link">
                                        ROP Tricks
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-3" type="checkbox"
                                  id="nav-8-2-3">

                                <label class="md-nav__link" for="nav-8-2-3">
                                  Format String Vulnerability
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-8-2-3">
                                    Format String Vulnerability
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/fmtstr/fmtstr_intro-zh/"
                                        title="Format String Vulnerability Principle" class="md-nav__link">
                                        Format String Vulnerability Principle
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/fmtstr/fmtstr_exploit-zh/"
                                        title="Format String Exploit" class="md-nav__link">
                                        Format String Exploit
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/fmtstr/fmtstr_example-zh/"
                                        title="Format String Vulnerability Example" class="md-nav__link">
                                        Format String Vulnerability Example
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/fmtstr/fmtstr_detect-zh/"
                                        title="Format String Vulnerability Detection" class="md-nav__link">
                                        Format String Vulnerability Detection
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-4" type="checkbox"
                                  id="nav-8-2-4">

                                <label class="md-nav__link" for="nav-8-2-4">
                                  Glibc Heap Related
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-8-2-4">
                                    Glibc Heap Related
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/glibc-heap/introduction-zh/"
                                        title="Introduction to Heap" class="md-nav__link">
                                        Introduction to Heap
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/glibc-heap/heap_overview-zh/" title="Heap Overview"
                                        class="md-nav__link">
                                        Heap Overview
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/glibc-heap/heap_structure-zh/"
                                        title="Heap Related Data Structure" class="md-nav__link">
                                        Heap Related Data Structure
                                      </a>
                                    </li>







                                    <li class="md-nav__item md-nav__item--nested">

                                      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-4-4"
                                        type="checkbox" id="nav-8-2-4-4">

                                      <label class="md-nav__link" for="nav-8-2-4-4">
                                        In-depth Understanding of Ptmalloc2
                                      </label>
                                      <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
                                        <label class="md-nav__title" for="nav-8-2-4-4">
                                          In-depth Understanding of Ptmalloc2
                                        </label>
                                        <ul class="md-nav__list" data-md-scrollfix>







                                          <li class="md-nav__item">
                                            <a href="../../../pwn/linux/glibc-heap/implementation/overview-zh/"
                                              title="Implementation" class="md-nav__link">
                                              Implementation
                                            </a>
                                          </li>







                                          <li class="md-nav__item">
                                            <a href="../../../pwn/linux/glibc-heap/implementation/basic-zh/"
                                              title="Basic Functions in the heap implementation" class="md-nav__link">
                                              Basic Functions in the heap implementation
                                            </a>
                                          </li>







                                          <li class="md-nav__item">
                                            <a href="../../../pwn/linux/glibc-heap/implementation/heap-init-zh/"
                                              title="Heap Initialization" class="md-nav__link">
                                              Heap Initialization
                                            </a>
                                          </li>







                                          <li class="md-nav__item">
                                            <a href="../../../pwn/linux/glibc-heap/implementation/malloc-zh/"
                                              title="Allocate Heap Memory" class="md-nav__link">
                                              Allocate Heap Memory
                                            </a>
                                          </li>







                                          <li class="md-nav__item">
                                            <a href="../../../pwn/linux/glibc-heap/implementation/free-zh/"
                                              title="Free Heap Memory" class="md-nav__link">
                                              Free Heap Memory
                                            </a>
                                          </li>







                                          <li class="md-nav__item">
                                            <a href="../../../pwn/linux/glibc-heap/implementation/tcache-zh/"
                                              title="Tcache" class="md-nav__link">
                                              Tcache
                                            </a>
                                          </li>







                                          <li class="md-nav__item">
                                            <a href="../../../pwn/linux/glibc-heap/implementation/malloc_state-zh/"
                                              title="malloc_state" class="md-nav__link">
                                              malloc_state
                                            </a>
                                          </li>







                                          <li class="md-nav__item">
                                            <a href="../../../pwn/linux/glibc-heap/implementation/misc-zh/"
                                              title="Other" class="md-nav__link">
                                              Other
                                            </a>
                                          </li>


                                        </ul>
                                      </nav>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/glibc-heap/heapoverflow_basic-zh/"
                                        title="Heap Overflow" class="md-nav__link">
                                        Heap Overflow
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/glibc-heap/off_by_one-zh/"
                                        title="Heap-based Off-By-One" class="md-nav__link">
                                        Heap-based Off-By-One
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/glibc-heap/chunk_extend_overlapping-zh/"
                                        title="Chunk Extend/Overlapping" class="md-nav__link">
                                        Chunk Extend/Overlapping
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/glibc-heap/unlink-zh/" title="Unlink"
                                        class="md-nav__link">
                                        Unlink
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/glibc-heap/use_after_free-zh/" title="Use After Free"
                                        class="md-nav__link">
                                        Use After Free
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/glibc-heap/fastbin_attack-zh/" title="Fastbin Attack"
                                        class="md-nav__link">
                                        Fastbin Attack
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/glibc-heap/unsorted_bin_attack-zh/"
                                        title="Unsorted Bin Attack" class="md-nav__link">
                                        Unsorted Bin Attack
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/glibc-heap/large_bin_attack-zh/"
                                        title="Large Bin Attack" class="md-nav__link">
                                        Large Bin Attack
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/glibc-heap/tcache_attack-zh/" title="Tcache Attack"
                                        class="md-nav__link">
                                        Tcache Attack
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/glibc-heap/house_of_einherjar-zh/"
                                        title="House of Einherjar" class="md-nav__link">
                                        House of Einherjar
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/glibc-heap/house_of_force-zh/" title="House of Force"
                                        class="md-nav__link">
                                        House of Force
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/glibc-heap/house_of_lore-zh/" title="House of Lore"
                                        class="md-nav__link">
                                        House of Lore
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/glibc-heap/house_of_orange-zh/"
                                        title="House of Orange" class="md-nav__link">
                                        House of Orange
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/glibc-heap/house_of_rabbit-zh/"
                                        title="House of Rabbit" class="md-nav__link">
                                        House of Rabbit
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/glibc-heap/house_of_roman-zh/" title="House of Roman"
                                        class="md-nav__link">
                                        House of Roman
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-5" type="checkbox"
                                  id="nav-8-2-5">

                                <label class="md-nav__link" for="nav-8-2-5">
                                  IO_FILE Related
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-8-2-5">
                                    IO_FILE Related
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/io_file/introduction-zh/"
                                        title="FILE Structure Description" class="md-nav__link">
                                        FILE Structure Description
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/io_file/fake-vtable-exploit-zh/"
                                        title="Forged Vtable to Hijack Control Flow" class="md-nav__link">
                                        Forged Vtable to Hijack Control Flow
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/io_file/fsop-zh/" title="FSOP" class="md-nav__link">
                                        FSOP
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/io_file/exploit-in-libc2.24-zh/"
                                        title="Use of IO_FILE Under Glibc 2.24" class="md-nav__link">
                                        Use of IO_FILE Under Glibc 2.24
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-6" type="checkbox"
                                  id="nav-8-2-6">

                                <label class="md-nav__link" for="nav-8-2-6">
                                  Race Condition
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-8-2-6">
                                    Race Condition
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/race-condition/introduction-zh/"
                                        title="Race Condition Introduction" class="md-nav__link">
                                        Race Condition Introduction
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/race-condition/problem-zh/" title="Example"
                                        class="md-nav__link">
                                        Example
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-7" type="checkbox"
                                  id="nav-8-2-7">

                                <label class="md-nav__link" for="nav-8-2-7">
                                  Integer Overflow
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-8-2-7">
                                    Integer Overflow
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/integeroverflow/intof-zh/"
                                        title="Introduction to The Principle of Integer Overflow" class="md-nav__link">
                                        Introduction to The Principle of Integer Overflow
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-8" type="checkbox"
                                  id="nav-8-2-8">

                                <label class="md-nav__link" for="nav-8-2-8">
                                  Sandbox Escape
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-8-2-8">
                                    Sandbox Escape
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/sandbox/python-sandbox-escape-zh/"
                                        title="Python Sandbox Escape" class="md-nav__link">
                                        Python Sandbox Escape
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-9" type="checkbox"
                                  id="nav-8-2-9">

                                <label class="md-nav__link" for="nav-8-2-9">
                                  Linux Kernel
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-8-2-9">
                                    Linux Kernel
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/kernel/environment-zh/" title="Environment Setup"
                                        class="md-nav__link">
                                        Environment Setup
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/kernel/basic_knowledge-zh/" title="Basics"
                                        class="md-nav__link">
                                        Basics
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/kernel/kernel_uaf-zh/" title="Kernel-UAF"
                                        class="md-nav__link">
                                        Kernel-UAF
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/kernel/kernel_rop-zh/" title="Kernel-ROP"
                                        class="md-nav__link">
                                        Kernel-ROP
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/kernel/ret2usr-zh/" title="ret2usr"
                                        class="md-nav__link">
                                        ret2usr
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/kernel/bypass_smep-zh/" title="bypass-smep"
                                        class="md-nav__link">
                                        bypass-smep
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/kernel/double-fetch-zh/" title="Double Fetch"
                                        class="md-nav__link">
                                        Double Fetch
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-10" type="checkbox"
                                  id="nav-8-2-10">

                                <label class="md-nav__link" for="nav-8-2-10">
                                  arm-pwn
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-8-2-10">
                                    arm-pwn
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/arm/environment-zh/" title="Environment Setup"
                                        class="md-nav__link">
                                        Environment Setup
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/arm/arm_rop-zh/" title="arm-rop" class="md-nav__link">
                                        arm-rop
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-2-11" type="checkbox"
                                  id="nav-8-2-11">

                                <label class="md-nav__link" for="nav-8-2-11">
                                  Summary
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-8-2-11">
                                    Summary
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/summary/get-address-zh/" title="Address Leaking"
                                        class="md-nav__link">
                                        Address Leaking
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/summary/hijack-control-flow-zh/"
                                        title="Hijack Control Flow" class="md-nav__link">
                                        Hijack Control Flow
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/linux/summary/get-shell-zh/" title="Get Shell"
                                        class="md-nav__link">
                                        Get Shell
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>


                            </ul>
                          </nav>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-3" type="checkbox" id="nav-8-3">

                          <label class="md-nav__link" for="nav-8-3">
                            Windows Pwn
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-8-3">
                              Windows Pwn
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../pwn/windows/readme-zh/" title="Overview" class="md-nav__link">
                                  Overview
                                </a>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-3-2" type="checkbox"
                                  id="nav-8-3-2">

                                <label class="md-nav__link" for="nav-8-3-2">
                                  Stack Overflow
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-8-3-2">
                                    Stack Overflow
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/windows/stackoverflow/stack-introduce-zh/"
                                        title="Stack Introduction" class="md-nav__link">
                                        Stack Introduction
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/windows/stackoverflow/stackoverflow-basic-zh/"
                                        title="Stack Overflow Principle" class="md-nav__link">
                                        Stack Overflow Principle
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../pwn/windows/stackoverflow/shellcode-in-stack-zh/"
                                        title="shellcode-in-stack" class="md-nav__link">
                                        shellcode-in-stack
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>


                            </ul>
                          </nav>
                        </li>


                      </ul>
                    </nav>
                  </li>







                  <li class="md-nav__item md-nav__item--nested">

                    <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">

                    <label class="md-nav__link" for="nav-9">
                      Android
                    </label>
                    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
                      <label class="md-nav__title" for="nav-9">
                        Android
                      </label>
                      <ul class="md-nav__list" data-md-scrollfix>







                        <li class="md-nav__item">
                          <a href="../../../android/basic_develop/basic_develop-zh/" title="Android Development Basics"
                            class="md-nav__link">
                            Android Development Basics
                          </a>
                        </li>







                        <li class="md-nav__item md-nav__item--nested">

                          <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2" type="checkbox" id="nav-9-2">

                          <label class="md-nav__link" for="nav-9-2">
                            Android Application Operating Mechanism Brief
                          </label>
                          <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
                            <label class="md-nav__title" for="nav-9-2">
                              Android Application Operating Mechanism Brief
                            </label>
                            <ul class="md-nav__list" data-md-scrollfix>







                              <li class="md-nav__item">
                                <a href="../../../android/basic_operating_mechanism/readme-zh/" title="Basics"
                                  class="md-nav__link">
                                  Basics
                                </a>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2-2" type="checkbox"
                                  id="nav-9-2-2">

                                <label class="md-nav__link" for="nav-9-2-2">
                                  The Operating Mechanism of the Java Layer in Android
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-9-2-2">
                                    The Operating Mechanism of the Java Layer in Android
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../android/basic_operating_mechanism/java_layer/readme-zh/"
                                        title="Andriod Native" class="md-nav__link">
                                        Andriod Native
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../android/basic_operating_mechanism/java_layer/smali/smali-zh/"
                                        title="Smali Introduction" class="md-nav__link">
                                        Smali Introduction
                                      </a>
                                    </li>







                                    <li class="md-nav__item md-nav__item--nested">

                                      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2-2-3"
                                        type="checkbox" id="nav-9-2-2-3">

                                      <label class="md-nav__link" for="nav-9-2-2-3">
                                        Dex and ODEX
                                      </label>
                                      <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
                                        <label class="md-nav__title" for="nav-9-2-2-3">
                                          Dex and ODEX
                                        </label>
                                        <ul class="md-nav__list" data-md-scrollfix>







                                          <li class="md-nav__item">
                                            <a href="../../../android/basic_operating_mechanism/java_layer/dex/dex-zh/"
                                              title="DEX" class="md-nav__link">
                                              DEX
                                            </a>
                                          </li>







                                          <li class="md-nav__item">
                                            <a href="../../../android/basic_operating_mechanism/java_layer/dex/odex-zh/"
                                              title="ODEX" class="md-nav__link">
                                              ODEX
                                            </a>
                                          </li>


                                        </ul>
                                      </nav>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2-3" type="checkbox"
                                  id="nav-9-2-3">

                                <label class="md-nav__link" for="nav-9-2-3">
                                  Android Native Layer Introduction
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-9-2-3">
                                    Android Native Layer Introduction
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../android/basic_operating_mechanism/native_layer/so-zh/"
                                        title="Android SO" class="md-nav__link">
                                        Android SO
                                      </a>
                                    </li>


                                  </ul>
                                </nav>
                              </li>







                              <li class="md-nav__item md-nav__item--nested">

                                <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2-4" type="checkbox"
                                  id="nav-9-2-4">

                                <label class="md-nav__link" for="nav-9-2-4">
                                  Android Reverse Basic Introduction
                                </label>
                                <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
                                  <label class="md-nav__title" for="nav-9-2-4">
                                    Android Reverse Basic Introduction
                                  </label>
                                  <ul class="md-nav__list" data-md-scrollfix>







                                    <li class="md-nav__item">
                                      <a href="../../../android/basic_reverse/overview-zh/" title="Brief Description"
                                        class="md-nav__link">
                                        Brief Description
                                      </a>
                                    </li>







                                    <li class="md-nav__item">
                                      <a href="../../../android/basic_reverse/android_code_location-zh/"
                                        title="Android Key Part Location" class="md-nav__link">
                                        Android Key Part Location
                                      </a>
                                    </li>







                                    <li class="md-nav__item md-nav__item--nested">

                                      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2-4-3"
                                        type="checkbox" id="nav-9-2-4-3">

                                      <label class="md-nav__link" for="nav-9-2-4-3">
                                        Android Simple Static Analysis
                                      </label>
                                      <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
                                        <label class="md-nav__title" for="nav-9-2-4-3">
                                          Android Simple Static Analysis
                                        </label>
                                        <ul class="md-nav__list" data-md-scrollfix>







                                          <li class="md-nav__item">
                                            <a href="../../../android/basic_reverse/static/java-example-zh/"
                                              title="Android Java Layer Static Analysis" class="md-nav__link">
                                              Android Java Layer Static Analysis
                                            </a>
                                          </li>







                                          <li class="md-nav__item">
                                            <a href="../../../android/basic_reverse/static/so-example-zh/"
                                              title="Android Native Layer Static Analysis" class="md-nav__link">
                                              Android Native Layer Static Analysis
                                            </a>
                                          </li>







                                          <li class="md-nav__item">
                                            <a href="../../../android/basic_reverse/static/complex-example-zh/"
                                              title="Android Static Analysis Hybrid Example" class="md-nav__link">
                                              Android Static Analysis Hybrid Example
                                            </a>
                                          </li>


                                        </ul>
                                      </nav>
                                    </li>







                                    <li class="md-nav__item md-nav__item--nested">

                                      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-2-4-4"
                                        type="checkbox" id="nav-9-2-4-4">

                                      <label class="md-nav__link" for="nav-9-2-4-4">
                                        Android Simple Dynamic Analysis
                                      </label>
                                      <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
                                        <label class="md-nav__title" for="nav-9-2-4-4">
                                          Android Simple Dynamic Analysis
                                        </label>
                                        <ul class="md-nav__list" data-md-scrollfix>







                                          <li class="md-nav__item">
                                            <a href="../../../android/basic_reverse/dynamic/dynamic_debug-zh/"
                                              title="Dynamic Debugging" class="md-nav__link">
                                              Dynamic Debugging
                                            </a>
                                          </li>







                                          <li class="md-nav__item">
                                            <a href="../../../android/basic_reverse/dynamic/ida_native_debug-zh/"
                                              title="Android Dynamic Debugging SO" class="md-nav__link">
                                              Android Dynamic Debugging SO
                                            </a>
                                          </li>


                                        </ul>
                                      </nav>
                                    </li>


                                  </ul>
                                </nav>
                              </li>


                            </ul>
                          </nav>
                        </li>


                      </ul>
                    </nav>
                  </li>







                  <li class="md-nav__item md-nav__item--nested">

                    <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">

                    <label class="md-nav__link" for="nav-10">
                      ICS
                    </label>
                    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
                      <label class="md-nav__title" for="nav-10">
                        ICS
                      </label>
                      <ul class="md-nav__list" data-md-scrollfix>







                        <li class="md-nav__item">
                          <a href="../../../ics/ctfs-zh/" title="ICS_CTF Contest" class="md-nav__link">
                            ICS_CTF Contest
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../ics/discover-zh/" title="ICS_CTF found" class="md-nav__link">
                            ICS_CTF found
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../ics/exploit-zh/" title="ICS_CTF uses" class="md-nav__link">
                            ICS_CTF uses
                          </a>
                        </li>







                        <li class="md-nav__item">
                          <a href="../../../ics/learn-zh/" title="ICS_CTF Learning Resources" class="md-nav__link">
                            ICS_CTF Learning Resources
                          </a>
                        </li>


                      </ul>
                    </nav>
                  </li>


                </ul>
              </nav>
            </div>
          </div>
        </div>


        <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
          <div class="md-sidebar__scrollwrap">
            <div class="md-sidebar__inner">

              <nav class="md-nav md-nav--secondary">





                <label class="md-nav__title" for="__toc">目录</label>
                <ul class="md-nav__list" data-md-scrollfix>

                  <li class="md-nav__item">
                    <a href="#_2" class="md-nav__link">
                      运行程序
                    </a>

                  </li>

                  <li class="md-nav__item">
                    <a href="#_3" class="md-nav__link">
                      获取用户输入
                    </a>

                  </li>

                  <li class="md-nav__item">
                    <a href="#_4" class="md-nav__link">
                      处理用户输入
                    </a>

                  </li>

                  <li class="md-nav__item">
                    <a href="#seh" class="md-nav__link">
                      注册SEH
                    </a>

                  </li>

                  <li class="md-nav__item">
                    <a href="#_5" class="md-nav__link">
                      恢复堆栈平衡
                    </a>

                  </li>

                  <li class="md-nav__item">
                    <a href="#_6" class="md-nav__link">
                      虚拟机指令分析
                    </a>

                  </li>





                  <li class="md-nav__item">
                    <a href="#__comments" class="md-nav__link md-nav__link--active">
                      评论
                    </a>
                  </li>

                </ul>

              </nav>
            </div>
          </div>
        </div>


        <div class="md-content">
          <article class="md-content__inner md-typeset">


            <a href="https://github.com/ctf-wiki/ctf-wiki/blob/master/docs/reverse/vm/vm-zh.md" title="编辑此页"
              class="md-icon md-content__icon">&#xE3C9;</a>


            <p><a href="../vm/">EN</a> | <a href="./">ZH</a></p>
            <h1 id="_1">虚拟机分析<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
            <p>有关虚拟机分析部分, 我们以一道简单的crackme来进行讲解. </p>
            <p>对应的<code>crackme</code>可以点击此处下载: <a
                href="https://github.com/ctf-wiki/ctf-challenges/blob/master/reverse/vm/fuelvm/FuelVM.exe">FuelVM.exe</a>
            </p>
            <p>对应的<code>keygenme</code>可以点击此处下载: <a
                href="https://github.com/ctf-wiki/ctf-challenges/blob/master/reverse/vm/fuelvm/fuelvm_keygen.py">fuelvm_keygen.py</a>
            </p>
            <p>对应的<code>IDA数据库</code>可以点击此处下载: <a
                href="https://github.com/ctf-wiki/ctf-challenges/blob/master/reverse/vm/fuelvm/FuelVM.idb">FuelVM.idb</a>
            </p>
            <p>本题作者设计了一个具有多种指令的简单虚拟机. 我们使用IDA来进行分析. 并为了方便讲解, 我对反汇编出的一些变量重新进行了命名. </p>
            <h2 id="_2">运行程序<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
            <p>我们运行程序 FuelVM.exe. 界面如下所示</p>
            <p><img alt="start.png" src="../figure/start.png" /></p>
            <p>在这个界面中, 我们看到右两个输入框, 一个用于输入用户名Name, 另一个则用于输入密钥Key. 还有两个按钮, Go用于提交输入, 而Exit则用于退出程序.</p>
            <h2 id="_3">获取用户输入<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
            <p>那么我们就可以从这里入手. 程序想获取用户输入, 需要调用的一个API是<code>GetDlgItemTextA()</code></p>
            <div class="codehilite">
              <pre><span></span><code><span class="n">UINT</span> <span class="nf">GetDlgItemTextA</span><span class="p">(</span>
  <span class="n">HWND</span>  <span class="n">hDlg</span><span class="p">,</span>
  <span class="kt">int</span>   <span class="n">nIDDlgItem</span><span class="p">,</span>
  <span class="n">LPSTR</span> <span class="n">lpString</span><span class="p">,</span>
  <span class="kt">int</span>   <span class="n">cchMax</span>
<span class="p">);</span>
</code></pre>
            </div>

            <p>获取的输入字符串会保存在<code>lpString</code>里. 那么我们就可以打开IDA查找有交叉引用<code>GetDlgItemTextA()</code>的地方.</p>
            <div class="codehilite">
              <pre><span></span><code><span class="nl">.text:</span><span class="err">00401142</span>                 <span class="nf">push</span>    <span class="mi">0</span><span class="no">Ch</span>             <span class="c">; cchMax</span>
<span class="nl">.text:</span><span class="err">00401144</span>                 <span class="nf">push</span>    <span class="no">offset</span> <span class="no">inputName</span> <span class="c">; lpString</span>
<span class="nl">.text:</span><span class="err">00401149</span>                 <span class="nf">push</span>    <span class="mi">3</span><span class="no">F8h</span>            <span class="c">; nIDDlgItem</span>
<span class="nl">.text:</span><span class="err">0040114</span><span class="nf">E</span>                 <span class="no">push</span>    <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">hWnd</span><span class="p">]</span>      <span class="c">; hDlg</span>
<span class="nl">.text:</span><span class="err">00401151</span>                 <span class="nf">call</span>    <span class="no">GetDlgItemTextA</span>
<span class="nl">.text:</span><span class="err">00401156</span>                 <span class="nf">push</span>    <span class="mi">0</span><span class="no">Ch</span>             <span class="c">; cchMax</span>
<span class="nl">.text:</span><span class="err">00401158</span>                 <span class="nf">push</span>    <span class="no">offset</span> <span class="no">inputKey</span> <span class="c">; lpString</span>
<span class="nl">.text:</span><span class="err">0040115</span><span class="nf">D</span>                 <span class="no">push</span>    <span class="mi">3</span><span class="no">F9h</span>            <span class="c">; nIDDlgItem</span>
<span class="nl">.text:</span><span class="err">00401162</span>                 <span class="nf">push</span>    <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">hWnd</span><span class="p">]</span>      <span class="c">; hDlg</span>
<span class="nl">.text:</span><span class="err">00401165</span>                 <span class="nf">call</span>    <span class="no">GetDlgItemTextA</span>
<span class="nl">.text:</span><span class="err">0040116</span><span class="nf">A</span>                 <span class="no">mov</span>     <span class="no">var_a</span><span class="p">,</span> <span class="mi">0</span>
<span class="nl">.text:</span><span class="err">00401171</span>                 <span class="nf">call</span>    <span class="no">process_input</span>
<span class="nl">.text:</span><span class="err">00401176</span>                 <span class="nf">jmp</span>     <span class="no">short</span> <span class="no">locExit</span>
</code></pre>
            </div>

            <p>如上, IDA只有这里调用过<code>GetDlgItemTextA</code>并且调用了两次分别获取<code>inputName</code>和<code>inputKey</code>.
              随后初始化了一个变量为0, 因为还不明白这个变量的作用, 因此先重命名为<code>var_a</code>. 之后进行了一次函数调用并jmp跳转. 因为jmp跳转位置的代码是一些退出程序的代码,
              因此我们可以断定上面的这个call, 是在调用处理用户输入的函数. 因此将jmp的位置重命名为<code>locExit</code>, 函数则重命名为<code>process_input</code>.
            </p>
            <h2 id="_4">处理用户输入<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
            <p>我们进入<code>process_input</code>函数, 该函数仅仅对输入字符串进行了很简单的处理. </p>
            <div class="codehilite">
              <pre><span></span><code>  <span class="n">result</span> <span class="o">=</span> <span class="n">strlength</span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">inputName</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v1</span> <span class="o">&gt;=</span> <span class="mi">7</span> <span class="p">)</span>                                <span class="c1">// v1 = length of inputName</span>
  <span class="p">{</span>
    <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">lenOfName</span> <span class="o">=</span> <span class="n">v1</span><span class="p">;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">strlength</span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">inputKey</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v2</span> <span class="o">&gt;=</span> <span class="mi">7</span> <span class="p">)</span>                              <span class="c1">// v2 = length of inputKey</span>
    <span class="p">{</span>
      <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="k">do</span>
      <span class="p">{</span>
        <span class="n">inputName</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^=</span> <span class="n">i</span><span class="p">;</span>
        <span class="o">++</span><span class="n">i</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">while</span> <span class="p">(</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">lenOfName</span> <span class="p">);</span>
      <span class="n">unk_4031CE</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
      <span class="n">dword_4031C8</span> <span class="o">=</span> <span class="n">dword_4035FF</span><span class="p">;</span>
      <span class="n">initVM</span><span class="p">();</span>
      <span class="n">initVM</span><span class="p">();</span>
      <span class="n">__debugbreak</span><span class="p">();</span>
      <span class="n">JUMPOUT</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">word_4012CE</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
</code></pre>
            </div>

            <p>首先是这个<code>strlength()</code>函数.
              函数使用<code>cld; repne scasb; not ecx; dec ecx</code>来计算字符串长度并将结果保存在<code>ecx</code>里. 是汇编基础知识就不多介绍.
              所以我们将该函数重命名为<code>strlength</code></p>
            <div class="codehilite">
              <pre><span></span><code><span class="nl">.text:</span><span class="err">004011</span><span class="nf">C2</span> <span class="no">arg_0</span>           <span class="err">=</span> <span class="no">dword</span> <span class="no">ptr</span>  <span class="mi">8</span>
<span class="nl">.text:</span><span class="err">004011</span><span class="nf">C2</span>
<span class="nl">.text:</span><span class="err">004011</span><span class="nf">C2</span>                 <span class="no">push</span>    <span class="no">ebp</span>
<span class="nl">.text:</span><span class="err">004011</span><span class="nf">C3</span>                 <span class="no">mov</span>     <span class="no">ebp</span><span class="p">,</span> <span class="no">esp</span>
<span class="nl">.text:</span><span class="err">004011</span><span class="nf">C5</span>                 <span class="no">mov</span>     <span class="no">edi</span><span class="p">,</span> <span class="p">[</span><span class="no">ebp</span><span class="err">+</span><span class="no">arg_0</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">004011</span><span class="nf">C8</span>                 <span class="no">sub</span>     <span class="no">ecx</span><span class="p">,</span> <span class="no">ecx</span>
<span class="nl">.text:</span><span class="err">004011</span><span class="nf">CA</span>                 <span class="no">sub</span>     <span class="no">al</span><span class="p">,</span> <span class="no">al</span>
<span class="nl">.text:</span><span class="err">004011</span><span class="nf">CC</span>                 <span class="no">not</span>     <span class="no">ecx</span>
<span class="nl">.text:</span><span class="err">004011</span><span class="nf">CE</span>                 <span class="no">cld</span>
<span class="nl">.text:</span><span class="err">004011</span><span class="nf">CF</span>                 <span class="no">repne</span> <span class="no">scasb</span>
<span class="nl">.text:</span><span class="err">004011</span><span class="nf">D1</span>                 <span class="no">not</span>     <span class="no">ecx</span>
<span class="nl">.text:</span><span class="err">004011</span><span class="nf">D3</span>                 <span class="no">dec</span>     <span class="no">ecx</span>
<span class="nl">.text:</span><span class="err">004011</span><span class="nf">D4</span>                 <span class="no">leave</span>
<span class="nl">.text:</span><span class="err">004011</span><span class="nf">D5</span>                 <span class="no">retn</span>    <span class="mi">4</span>
<span class="nl">.text:</span><span class="err">004011</span><span class="nf">D5</span> <span class="no">strlength</span>       <span class="no">endp</span>
</code></pre>
            </div>

            <p>而在IDA生成的伪C代码处有<code>v1</code>和<code>v2</code>, 我对其进行了注解, 可以看汇编, 里面是使用<code>ecx</code>与<code>7</code>进行比较,
              而<code>ecx</code>是字符串的长度, 于是我们可以知道, 这里对输入的要求是: <em>inputName 和 inputKey 的长度均不少于 7</em></p>
            <p>当<code>inputName</code>和<code>inputKey</code>长度均不少于7时, 那么就可以对输入进行简单的变换. 以下是一个循环</p>
            <div class="codehilite">
              <pre><span></span><code>      <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="k">do</span>
      <span class="p">{</span>
        <span class="n">inputName</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^=</span> <span class="n">i</span><span class="p">;</span>
        <span class="o">++</span><span class="n">i</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">while</span> <span class="p">(</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">lenOfName</span> <span class="p">);</span>
</code></pre>
            </div>

            <p>对应的python代码即</p>
            <div class="codehilite">
              <pre><span></span><code><span class="k">def</span> <span class="nf">obfuscate</span><span class="p">(</span><span class="n">username</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">username</span><span class="p">)):</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">username</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">^</span> <span class="n">i</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">s</span>
</code></pre>
            </div>

            <p>函数之后对一些变量进行了赋值(这些并不重要, 就忽略不讲了.) </p>
            <h2 id="seh">注册SEH<a class="headerlink" href="#seh" title="Permanent link">&para;</a></h2>
            <div class="codehilite">
              <pre><span></span><code><span class="nl">.text:</span><span class="err">004012</span><span class="nf">B5</span>                 <span class="no">push</span>    <span class="no">offset</span> <span class="no">seh_handler</span>
<span class="nl">.text:</span><span class="err">004012</span><span class="nf">BA</span>                 <span class="no">push</span>    <span class="no">large</span> <span class="no">dword</span> <span class="no">ptr</span> <span class="no">fs</span><span class="p">:</span><span class="mi">0</span>
<span class="nl">.text:</span><span class="err">004012</span><span class="nf">C1</span>                 <span class="no">mov</span>     <span class="no">large</span> <span class="no">fs</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="no">esp</span>
<span class="nl">.text:</span><span class="err">004012</span><span class="nf">C8</span>                 <span class="no">call</span>    <span class="no">initVM</span>
<span class="nl">.text:</span><span class="err">004012</span><span class="nf">CD</span>                 <span class="no">int</span>     <span class="mi">3</span>               <span class="c">; Trap to Debugger</span>
</code></pre>
            </div>

            <p><code>initVM</code>完成的是一些虚拟机启动前的初始化工作(其实就是对一些寄存器和相关的部分赋初值), 我们之后来讨论. 这里我们关注的是SEH部分. 这里注册了一个SEH句柄,
              异常处理函数我重命名为<code>seh_handler</code>, 并之后使用<code>int 3</code>手动触发异常. 而在<code>seh_handler</code>位置,
              IDA并未正确识别出对应的代码</p>
            <div class="codehilite">
              <pre><span></span><code>.text:004012D7 seh_handler     db 64h                  ; DATA XREF: process_input+7Do
.text:004012D8                 dd 58Fh, 0C4830000h, 13066804h, 0FF640040h, 35h, 25896400h
.text:004012D8                 dd 0
.text:004012F4                 dd 1B8h, 0F7C93300h, 0F7C033F1h, 0FFC483E1h, 8F64FDEBh
.text:004012F4                 dd 5, 4C48300h, 40133068h, 35FF6400h, 0
.text:0040131C                 dd 258964h, 33000000h, 33198BC9h, 83E1F7C0h, 0FDEBFFC4h
.text:0040131C                 dd 58F64h, 83000000h, 5E6804C4h, 64004013h, 35FFh, 89640000h
.text:0040131C                 dd 25h, 0C033CC00h, 0C483E1F7h, 83FDEBFFh, 4035FF05h, 0D8B0200h
.text:0040131C                 dd 4035FFh, 3000B1FFh, 58F0040h, 4031C8h, 31C83D80h, 750A0040h
.text:0040131C                 dd 0B1FF4176h, 403000h, 31C8058Fh, 3D800040h, 4031C8h
</code></pre>
            </div>

            <p>我们可以点击相应位置按下<code>c</code>键, 将这些数据转换成代码进行识别. (我们需要按下多次c键进行转换), 得到如下代码.</p>
            <p>如下, 在<code>seh_handler</code>位置, 又用类似的方法注册了一个位于<code>401306h</code>的异常处理函数,
              并通过<code>xor ecx,ecx; div ecx</code>手动触发了一个<code>除0异常</code>. 而在<code>loc_401301</code>位置, 这是一个反调试技巧,
              <code>jmp loc_401301+2</code>会使得<code>EIP</code>转向一条指令中间, 使得无法继续调试.
              所以我们可以将<code>00401301~00401306</code>部分的代码<code>nop</code>掉,
              然后在<code>00401306</code>位置创建一个新函数<code>seh_handler2</code></p>
            <div class="codehilite">
              <pre><span></span><code>seh_handler:                            ; DATA XREF: process_input+7Do
.text:004012D7                 pop     large dword ptr fs:0
.text:004012DE                 add     esp, 4
.text:004012E1                 push    401306h
.text:004012E6                 push    large dword ptr fs:0
.text:004012ED                 mov     large fs:0, esp
.text:004012F4                 mov     eax, 1
.text:004012F9                 xor     ecx, ecx
.text:004012FB                 div     ecx
.text:004012FD                 xor     eax, eax
.text:004012FF                 mul     ecx
.text:00401301
.text:00401301 loc_401301:                             ; CODE XREF: .text:00401304j
.text:00401301                 add     esp, 0FFFFFFFFh
.text:00401304                 jmp     short near ptr loc_401301+2
.text:00401306 ; ---------------------------------------------------------------------------
.text:00401306                 pop     large dword ptr fs:0
.text:0040130D                 add     esp, 4
.text:00401310                 push    401330h
.text:00401315                 push    large dword ptr fs:0
.text:0040131C                 mov     large fs:0, esp
.text:00401323                 xor     ecx, ecx
.text:00401325                 mov     ebx, [ecx]
.text:00401327                 xor     eax, eax
.text:00401329                 mul     ecx
</code></pre>
            </div>

            <p>类似的, 还有<code>401330h</code>重命名为<code>seh_handler3</code>, 而<code>40135Eh</code>是最后一个注册的异常处理函数,
              我们可以推测这才是虚拟机真正的main函数, 因此我们将<code>40135Eh</code>重命名为<code>vm_main</code>. (有关SEH和反调试的部分,
              可以推荐大家自己去动态调试一番弄清楚)</p>
            <h2 id="_5">恢复堆栈平衡<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
            <p>我们创建了一个<code>vm_main</code>函数(重命名后还需要创建函数, IDA才能识别), 然后按下<code>F5</code>提示失败, 失败的原因则是由于堆栈不平衡导致的.
              因此我们可以点击IDA菜单项<code>Options-&gt;General</code>在右侧勾选<code>stack pointer</code>. 这样就会显示出对应的栈指针. </p>
            <div class="codehilite">
              <pre><span></span><code>.text:004017F2 000                 jmp     vm_main
.text:004017F7     ; ---------------------------------------------------------------------------
.text:004017F7 000                 push    0               ; uType
.text:004017F9 004                 push    offset aError   ; &quot;Error&quot;
.text:004017FE 008                 push    offset Text     ; &quot;The key is wrong.&quot;
.text:00401803 00C                 push    0               ; hWnd
.text:00401805 010                 call    MessageBoxA
.text:0040180A
.text:0040180A     locret_40180A:                          ; CODE XREF: vm_main+492j
.text:0040180A 000                 leave
.text:0040180B -04                 leave
.text:0040180C -08                 leave
.text:0040180D -0C                 leave
.text:0040180E -10                 leave
.text:0040180F -14                 leave
.text:00401810 -18                 leave
.text:00401811 -1C                 retn
.text:00401811     vm_main         endp ; sp-analysis failed
</code></pre>
            </div>

            <p>我们来到最下显示不平衡的位置. 最上的<code>jmp vm_main</code>表明虚拟机内在执行一个循环. 而<code>MessageBoxA</code>的调用则是显示最后弹出的错误信息.
              而在<code>locret_40180A</code>位置处, 经过多次leave堆栈严重不平衡, 因此我们需要手动恢复堆栈平衡. </p>
            <p>这里也很简单, 在<code>0040180A</code>位置已经堆栈平衡了(000), 因此我们只需要将这一句<code>leave</code>修改为<code>retn</code>就可以了. 如下这样
            </p>
            <div class="codehilite">
              <pre><span></span><code>.text:0040180A     locret_40180A:                          ; CODE XREF: vm_main+492j
.text:0040180A 000                 retn
.text:0040180B     ; ---------------------------------------------------------------------------
.text:0040180B 004                 leave
.text:0040180C 004                 leave
.text:0040180D 004                 leave
</code></pre>
            </div>

            <p>然后你就可以发现<code>vm_main</code>可以F5生成伪C代码了. </p>
            <h2 id="_6">虚拟机指令分析<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h2>
            <p>说实话, 虚拟机的分析部分是一个比较枯燥的还原过程, 你需要比对各个小部分的操作来判断这是一个怎样的指令, 使用的是哪些寄存器. 像这个crackme中,
              vm进行的是一个<code>取指-译码-执行</code>的循环. <code>译码</code>过程可给予我们的信息最多, 不同的指令都会在这里, 根据它们各自的<code>opcode</code>,
              使用<code>if-else if-else</code>分支进行区分. 实际的还原过程并不复杂, 但有可能会因为虚拟机实现的指令数量而显得有些乏味. </p>
            <p>最后分析出的结果如下:</p>
            <table>
              <thead>
                <tr>
                  <th>opcode</th>
                  <th>value</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>push</td>
                  <td>0x0a</td>
                </tr>
                <tr>
                  <td>pop</td>
                  <td>0x0b</td>
                </tr>
                <tr>
                  <td>mov</td>
                  <td>0x0c</td>
                </tr>
                <tr>
                  <td>cmp</td>
                  <td>0x0d</td>
                </tr>
                <tr>
                  <td>inc</td>
                  <td>0x0e</td>
                </tr>
                <tr>
                  <td>dec</td>
                  <td>0x0f</td>
                </tr>
                <tr>
                  <td>and</td>
                  <td>0x1b</td>
                </tr>
                <tr>
                  <td>or</td>
                  <td>0x1c</td>
                </tr>
                <tr>
                  <td>xor</td>
                  <td>0x1d</td>
                </tr>
                <tr>
                  <td>check</td>
                  <td>0xff</td>
                </tr>
              </tbody>
            </table>
            <p>我们再来看分析后的<code>initVM</code>函数</p>
            <div class="codehilite">
              <pre><span></span><code><span class="kt">int</span> <span class="nf">initVM</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// eax@1</span>

  <span class="n">r1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">r2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">r3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">inputName</span><span class="p">[(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">cur_index</span><span class="p">];</span>
  <span class="n">r4</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">inputName</span><span class="p">[(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">cur_index</span><span class="p">];</span>
  <span class="n">vm_sp</span> <span class="o">=</span> <span class="mh">0x32</span><span class="p">;</span>
  <span class="n">vm_pc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">vm_flags_zf</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">vm_flags_sf</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="o">++</span><span class="n">cur_index</span><span class="p">;</span>
  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
            </div>

            <p>这里有4个通用寄存器(<code>r1/r2/r3/r4</code>), 1个<code>sp</code>指针和1个<code>pc</code>指针,
              标志<code>zf</code>和<code>sf</code>. 先前我们不知道的<code>var_a</code>也被重命名为<code>cur_index</code>,
              指向的是<code>inputName</code>当前正在处理的字符索引. </p>
            <p>对于VM实现的多个指令我们就不再多说, 重点来看下<code>check</code>部分的操作.</p>
            <div class="codehilite">
              <pre><span></span><code><span class="kt">int</span> <span class="kr">__fastcall</span> <span class="nf">check</span><span class="p">(</span><span class="kt">int</span> <span class="n">a1</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">char</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// al@1</span>
  <span class="kt">int</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// eax@4</span>

  <span class="n">v1</span> <span class="o">=</span> <span class="n">r1</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">r1</span> <span class="o">&lt;</span> <span class="mh">0x21u</span> <span class="p">)</span>
    <span class="n">v1</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">+</span> <span class="mh">0x21</span><span class="p">;</span>
  <span class="n">LOBYTE</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span> <span class="o">=</span> <span class="n">cur_index</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v1</span> <span class="o">==</span> <span class="n">inputKey</span><span class="p">[</span><span class="n">a1</span><span class="p">]</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">cur_index</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">lenOfName</span> <span class="p">)</span>
      <span class="n">result</span> <span class="o">=</span> <span class="n">MessageBoxA</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">aGoodJobNowWrit</span><span class="p">,</span> <span class="n">Caption</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">else</span>
      <span class="n">result</span> <span class="o">=</span> <span class="n">initVM</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">MessageBoxA</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Text</span><span class="p">,</span> <span class="n">Caption</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
            </div>

            <p>如果<code>r1</code>中的值跟<code>inputKey[cur_index]</code>相等, 那么会继续判断是否已经检查完了整个<code>inputName</code>,
              如果没有出错且比对结束, 那么就会弹出<code>Good job! Now write a keygen.</code>的消息框.
              否则会继续<code>initVM</code>进入下一轮循环.(出错了当然是弹出消息框提示错误了. )</p>
            <p><code>cur_index</code>会在<code>initVM</code>中自增1,
              那么还记得之前在<code>process_input</code>里有执行2次<code>initVM</code>吗. 因为有执行2次<code>initVM</code>,
              所以我们的<code>inputKey</code>的前2位可以是任意字符. </p>
            <div class="codehilite">
              <pre><span></span><code>      <span class="n">unk_4031CE</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
      <span class="n">opcode</span> <span class="o">=</span> <span class="n">vm_pc</span><span class="p">;</span>
      <span class="n">initVM</span><span class="p">();</span>
      <span class="n">initVM</span><span class="p">();</span>
      <span class="n">__debugbreak</span><span class="p">();</span>
      <span class="n">JUMPOUT</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">word_4012CE</span><span class="p">);</span>
</code></pre>
            </div>

            <p>故而我们分析完了整个虚拟机, 便可以开始着手编写<code>Keygen</code>. </p>
            <p>对应的<code>keygenme</code>可以点击此处下载: <a
                href="https://github.com/ctf-wiki/ctf-challenges/blob/master/reverse/vm/fuelvm/fuelvm_keygen.py">fuelvm_keygen.py</a>
            </p>
            <div class="codehilite">
              <pre><span></span><code>$ python2 fuelvm_keygen.py ctf-wiki
<span class="o">[</span>*<span class="o">]</span> Password <span class="k">for</span> user <span class="s1">&#39;ctf-wiki&#39;</span> is: 4mRC*TKJI
</code></pre>
            </div>

            <p>对应的<code>IDA数据库</code>可以点击此处下载: <a
                href="https://github.com/ctf-wiki/ctf-challenges/blob/master/reverse/vm/fuelvm/FuelVM.idb">FuelVM.idb</a>
            </p>









            <h2 id="__comments">评论</h2>
            <div id="disqus_thread"></div>
            <script>
              var disqus_config = function () {
                this.page.url = "https://ctf-wiki.github.io/ctf-wiki/reverse/vm/vm-zh/";
                this.page.identifier =
                  "reverse/vm/vm-zh/";
              };
              (function () {
                var d = document, s = d.createElement("script");
                s.src = "//ctf-wiki.disqus.com/embed.js";
                s.setAttribute("data-timestamp", +new Date());
                (d.head || d.body).appendChild(s);
              })();
            </script>


          </article>
        </div>
      </div>
    </main>


    <footer class="md-footer">

      <div class="md-footer-nav">
        <nav class="md-footer-nav__inner md-grid">

          <a href="../../maze/maze-zh/" title="Labyrinth Problem"
            class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  上一页
                </span>
                Labyrinth Problem
              </span>
            </div>
          </a>


          <a href="../../unicorn/introduction-zh/" title="Unicorn Engine Introduction"
            class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  下一页
                </span>
                Unicorn Engine Introduction
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>

        </nav>
      </div>

      <div class="md-footer-meta md-typeset">
        <div class="md-footer-meta__inner md-grid">
          <div class="md-footer-copyright">

            <div class="md-footer-copyright__highlight">
              Copyright &copy; 2016 - 2020 CTF Wiki Team
            </div>

            powered by
            <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
            and
            <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
              Material for MkDocs</a>
          </div>

        </div>
      </div>
    </footer>

  </div>

  <script src="../../../assets/javascripts/application.c33a9706.js"></script>




  <script src="../../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>









  <script>app.initialize({ version: "1.0.4", url: { base: "../../.." } })</script>

  <script src="https://cdnjs.loli.net/ajax/libs/pangu/3.3.0/pangu.min.js"></script>

  <script src="../../../_static/js/extra.js"></script>

  <script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>


</body>

</html>
